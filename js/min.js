"use strict";const pageTitle=" on Simbiat Software";function attachListeners(){document.getElementById("content").addEventListener("scroll",backToTop),Array.from(document.getElementsByTagName("input")).forEach((e=>{ariaInit(e),!1===e.hasAttribute("placeholder")&&e.setAttribute("placeholder",e.value||e.type||"placeholder"),"color"===e.type&&(e.addEventListener("focus",colorValueOnEvent),e.addEventListener("change",colorValueOnEvent),e.addEventListener("input",colorValueOnEvent),colorValue(e))})),placeholders(),signInUpInit(),webShareInit(),bicInit(),detailsInit(),copyQuoteInit(),formInit(),galleryInit(),fftrackerInit(),document.querySelectorAll("#showSidebar, #hideSidebar").forEach((e=>{e.addEventListener("click",toggleSidebar)})),document.querySelectorAll("#showNav, #hideNav").forEach((e=>{e.addEventListener("click",toggleNav)})),document.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((e=>{idToHeader(e),e.addEventListener("click",anchorFromHeader)}));let e=document.getElementById("refresh_timer");e&&timer(e,!1),tooltipInit()}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n].getAttribute("content");return null}function timer(e,t=!0){setInterval((function(){parseInt(e.innerHTML)>0&&(e.innerHTML=!0===t?parseInt(e.innerHTML)+1:parseInt(e.innerHTML)-1)}),1e3)}function colorValue(e){e.setAttribute("value",e.value)}function colorValueOnEvent(e){colorValue(e.target)}function toggleSidebar(e){e.preventDefault();const t=document.getElementById("sidebar");t.classList.contains("shown")?t.classList.remove("shown"):t.classList.add("shown")}function toggleNav(e){e.preventDefault();const t=document.getElementById("navigation");t.classList.contains("shown")?t.classList.remove("shown"):t.classList.add("shown")}function updateHistory(e,t){document.title=t,window.history.pushState(t,t,e)}async function ajax(e,t=null,n="json",a="GET",r=6e4){let o,i=new AbortController;setTimeout((()=>i.abort()),r);try{let r=await fetch(e,{method:a,mode:"same-origin",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json","X-CSRFToken":getMeta("X-CSRFToken")},redirect:"error",referrer:window.location.href,referrerPolicy:"same-origin",keepalive:!1,signal:i.signal,body:"POST"===a?JSON.stringify(t):null});return r.ok?(o="json"===n?await r.json():"blob"===n?await r.blob():"array"===n?await r.arrayBuffer():"form"===n?await r.formData():await r.text(),o):(addSnackbar('Request to "'+e+'" returned code '+r.status,"failure",1e4),!1)}catch(t){if("AbortError"===t.name)return addSnackbar('Request to "'+e+'" timed out after '+r+" milliseconds","failure",1e4),!1;throw addSnackbar('Request to "'+e+'" failed on fetch operation',"failure",1e4),t}}function ariaInit(e){e.addEventListener("focus",ariaNationOnEvent),e.addEventListener("change",ariaNationOnEvent),e.addEventListener("input",ariaNationOnEvent),ariaNation(e)}function ariaNation(e){e.setAttribute("aria-invalid",!e.validity.valid),!0===e.hasAttribute("type")&&["text","search","url","tel","email","password","date","month","week","time","datetime-local","number","checkbox","radio","file"].includes(e.getAttribute("type"))&&(!0===e.required?e.setAttribute("aria-required",!0):e.setAttribute("aria-required",!1)),!0===e.hasAttribute("type")&&"checkbox"===e.getAttribute("type")&&(e.setAttribute("role","checkbox"),e.setAttribute("aria-checked",e.checked),!0===e.indeterminate&&e.setAttribute("aria-checked","mixed"))}function ariaNationOnEvent(e){ariaNation(e.target)}function backToTop(e){0===e.target.scrollTop?document.querySelectorAll(".back-to-top").forEach((e=>{e.classList.add("hidden"),e.removeEventListener("click",scrollToTop)})):document.querySelectorAll(".back-to-top").forEach((e=>{e.classList.remove("hidden"),e.addEventListener("click",scrollToTop)}))}function scrollToTop(){document.getElementById("content").scrollTop=0}function bicInit(){let e=document.getElementById("bic_key"),t=document.getElementById("account_key");e&&t&&(e.addEventListener("input",bicCalc),t.addEventListener("input",bicCalc));let n=document.getElementById("bicRefresh");n&&n.addEventListener("click",bicRefresh)}function bicCalc(){let e=document.getElementById("accCheckResult"),t=document.getElementById("bic_key"),n=document.getElementById("account_key"),a=document.getElementById("bic_key_sample"),r=document.getElementById("account_key_sample");if(e.classList.remove(...e.classList),null===/^[0-9]{9}$/u.exec(t.value))return e.classList.add("failure"),e.innerHTML="Неверный формат БИКа",void bicStyle(a,"warning","БИК");if(bicStyle(a,"success",t.value),null===/^[0-9]{5}[0-9АВСЕНКМРТХавсенкмртх][0-9]{14}$/u.exec(n.value))return e.classList.add("failure"),e.innerHTML="Неверный формат счёта",void bicStyle(r,"warning","СЧЁТ");bicStyle(r,"success",n.value),updateHistory(location.protocol+"//"+location.host+"/bictracker/keying/"+t.value+"/"+n.value+"/","Ключевание счёта "+n.value+pageTitle),e.classList.add("warning"),e.innerHTML="Проверяем...";let o=document.getElementById("bic_spinner");o.classList.remove("hidden"),ajax(location.protocol+"//"+location.host+"/api/bictracker/keying/"+t.value+"/"+n.value+"/").then((t=>{e.classList.remove(...e.classList),!0===t?(e.classList.add("success"),e.innerHTML="Правильное ключевание"):(e.classList.add("failure"),e.innerHTML=!1===t?"Непредвиденная ошибка":"Неверное ключевание. Ожидаемый ключ: "+t+" ("+n.value.replace(/(^[0-9]{5}[0-9АВСЕНКМРТХавсенкмртх][0-9]{2})([0-9])([0-9]{11})$/u,'$1<span class="success">'+t+"</span>$3")+")"),o.classList.add("hidden")}))}function bicStyle(e,t,n=""){e.classList.remove(...e.classList),e.classList.add(t),e.innerHTML=n}function bicRefresh(e){let t=e.target;t.classList.contains("spin")?(e.stopPropagation(),e.preventDefault()):(t.classList.add("spin"),setTimeout((async function(){await ajax(location.protocol+"//"+location.host+"/api/bictracker/dbupdate/",null,"json","GET",3e5).then((e=>{!0===e?addSnackbar("Библиотека БИК обновлена","success"):addSnackbar("Не удалось обновить библиотеку БИК","failure",1e4)})),t.classList.remove("spin")}),500))}function copyQuoteInit(){document.querySelectorAll("samp, code, blockquote").forEach((e=>{e.innerHTML='<img loading="lazy" decoding="async"  src="/img/copy.svg" alt="Copy block" class="copyQuote">'+e.innerHTML})),document.querySelectorAll(".copyQuote, q").forEach((e=>{e.addEventListener("click",copyQuote)}))}function copyQuote(e){let t,n;switch(t="q"===e.target.tagName.toLowerCase()?e.target:e.target.parentElement,t.tagName.toLowerCase()){case"samp":n="sample";break;case"code":n="code";break;case"blockquote":case"q":n="quote"}navigator.clipboard.writeText(t.textContent).then((function(){addSnackbar(n.charAt(0).toUpperCase()+n.slice(1)+" copied to clipboard","success")}),(function(){addSnackbar("Failed to copy "+n,"failure")}))}function placeholders(){Array.from(document.getElementsByTagName("textarea")).forEach((e=>{!1===e.hasAttribute("placeholder")&&e.setAttribute("placeholder",e.value||e.type||"placeholder")}))}function detailsInit(){document.querySelectorAll("details").forEach(((e,t,n)=>{e.ontoggle=t=>{e.open&&!1===e.classList.contains("persistent")&&n.forEach((t=>{t!==e&&!1===t.classList.contains("persistent")&&(t.open=!1)}))}})),window.addEventListener("click",(function(e){document.querySelectorAll("details").forEach((t=>{!0===t.classList.contains("popup")&&!1===t.contains(e.target)&&(t.open=!1)}))}))}function fftrackerInit(){let e=document.getElementById("ff_track_type");e&&e.addEventListener("change",(function(e){ffTrackTypeChange(e.target)}));let t=document.getElementById("ff_track_register");t&&(t.addEventListener("submit",(function(e){return e.preventDefault(),e.stopPropagation(),ffTrackAdd(),!1})),t.onkeydown=function(e){if("Enter"===e.code)return e.preventDefault(),e.stopPropagation(),ffTrackAdd(),!1})}function ffTrackAdd(){let e=document.getElementById("ff_track_id"),t=document.getElementById("ff_track_type");if(e&&t){let n=document.getElementById("ff_track_spinner");n.classList.remove("hidden"),ajax(location.protocol+"//"+location.host+"/api/fftracker/"+t.value+"/"+e.value+"/register/").then((a=>{!0===a?addSnackbar(t.options[t.selectedIndex].text+" with ID "+e.value+' was registered. Check <a href="'+location.protocol+"//"+location.host+"/fftracker/"+t.value+"/"+e.value+'/" target="_blank">here</a>.',"success",0):addSnackbar("404"===a?t.options[t.selectedIndex].text+" with ID "+e.value+" was not found on Lodestone.":t.options[t.selectedIndex].text+" with ID "+e.value+" failed to be registered. Please, try again later.","failure",1e4),n.classList.add("hidden")}))}}function ffTrackTypeChange(e){let t=document.getElementById("ff_track_id"),n="^\\d+$";switch(e.value){case"character":case"freecompany":case"linkshell":n="^\\d{1,20}$";break;case"pvpteam":case"crossworld_linkshell":n="^[0-9a-z]{40}$"}t.setAttribute("pattern",n)}!function(){let e;const t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"];let a=n.length;const r=window.console=window.console||{};for(;a--;)e=n[a],r[e]||(r[e]=t)}(),document.addEventListener("DOMContentLoaded",attachListeners);const textInputTypes=["email","password","search","tel","text","url"],nonTextInputTypes=["checkbox","color","date","datetime-local","file","month","number","radio","time","week"];function formInit(){document.querySelectorAll("form").forEach((e=>{e.addEventListener("keypress",formEnter)})),document.querySelectorAll("form[data-baseURL] input[type=search]").forEach((e=>{e.addEventListener("input",searchAction),e.addEventListener("change",searchAction),e.addEventListener("focus",searchAction)})),document.querySelectorAll("form input").forEach((e=>{textInputTypes.includes(e.type)&&(e.addEventListener("keydown",inputBackSpace),e.getAttribute("maxlength")&&(e.addEventListener("input",autoNext),e.addEventListener("change",autoNext),e.addEventListener("paste",pasteSplit))),nonTextInputTypes.includes(e.type)}))}function searchAction(e){let t=e.target,n=t.form;""===t.value?n.action=n.getAttribute("data-baseURL"):n.action=n.getAttribute("data-baseURL")+t.value,n.method="get"}function formEnter(e){let t=e.target.form;if(!(13!==(e.keyCode||e.charCode||0)||t.action&&t.getAttribute("data-baseURL")&&location.protocol+"//"+location.host+t.getAttribute("data-baseURL")!==t.action))return e.stopPropagation(),e.preventDefault(),!1}function inputBackSpace(e){let t=e.target;if(8===(e.keyCode||e.charCode||0)&&!t.value){let e=nextInput(t,!0);e&&(e.focus(),e.selectionStart=e.selectionEnd=e.value.length)}}function autoNext(e){let t=e.target,n=parseInt(t.getAttribute("maxlength"));if(n&&t.value.length===n&&t.validity.valid){let e=nextInput(t,!1);e&&e.focus()}}async function pasteSplit(e){if("denied"===(await navigator.permissions.query({name:"clipboard-read"})).state)return!1;navigator.clipboard.readText().then((t=>{let n=t.toString(),a=e.target,r=parseInt(a.getAttribute("maxlength"));for(;a&&r&&n.length>r;){if(a.value=n.substring(0,r),a.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),!a.validity.valid)return!1;n=n.substring(r),a=nextInput(a),a&&(a.focus(),r=parseInt(a.getAttribute("maxlength")))}a&&(a.value=n,a.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})))})).catch((e=>{navigator.permissions.query({name:"clipboard-read"}).then((t=>{"granted"===t.state?console.error("Failed to read clipboard",e):addSnackbar("Failed to read clipboard","warning")})).catch((e=>{console.error("Failed to check clipboard permission",e)}))}))}function nextInput(e,t=!1){let n=e.form;if(n){let a;for(let r of n.querySelectorAll("input")){if(t){if(r===e)return a||!1}else if(a===e)return r;a=r}}return!1}let galleryCurrent=1,galleryList=[];function galleryInit(){Array.from(document.getElementsByClassName("galleryZoom")).forEach((e=>{e.addEventListener("click",(function(e){return e.preventDefault(),e.stopPropagation(),galleryOpen(e.target),!1}))})),document.getElementById("galleryClose").addEventListener("click",galleryClose),document.getElementById("galleryPrevious").addEventListener("click",galleryPrevious),document.getElementById("galleryNext").addEventListener("click",galleryNext)}function galleryOpen(e){let t;galleryCount(),t="a"===e.tagName.toLowerCase()?e:e.closest("a"),galleryCurrent=galleryGetIndex(t),galleryLoadImage(),document.getElementById("galleryOverlay").classList.remove("hidden")}function galleryLoadImage(){let e=galleryList[galleryCurrent-1],t=e.getAttribute("data-tooltip")??e.getAttribute("title")??e.href.replace(/^.*[\\\/]/u,"");document.getElementById("galleryName").innerText=t,document.getElementById("galleryNameLink").innerHTML='<a href="'+e.href+'" target="_blank"><img loading="lazy" decoding="async" class="linkIcon" alt="Open in new tab" src="/img/newtab.svg"></a>',document.getElementById("galleryTotal").innerText=galleryList.length.toString(),document.getElementById("galleryCurrent").innerText=galleryCurrent.toString(),document.getElementById("galleryImage").innerHTML='<img id="galleryLoadedImage" loading="lazy" decoding="async" alt="'+t+'" src="'+e.href+'">',document.getElementById("galleryLoadedImage").addEventListener("click",galleryZoom)}function galleryClose(){document.getElementById("galleryOverlay").classList.add("hidden")}function galleryCount(){galleryList=[],galleryList=document.querySelectorAll(".galleryZoom")}function galleryGetIndex(e){return Array.from(galleryList).indexOf(e)+1}function galleryPrevious(){galleryCurrent-=1,galleryCurrent<1&&(galleryCurrent=galleryList.length),galleryLoadImage(galleryCurrent)}function galleryNext(){galleryCurrent+=1,galleryCurrent>galleryList.length&&(galleryCurrent=1),galleryLoadImage(galleryCurrent)}function galleryZoom(){let e=document.getElementById("galleryLoadedImage");e.classList.contains("zoomedIn")?e.classList.remove("zoomedIn"):e.classList.add("zoomedIn")}function idToHeader(e){if(!1===e.hasAttribute("id")){let t=e.textContent.replaceAll(/\s/gmu,"_").replaceAll(/[^\p{L}\p{N}_\-]/gmu,"").replaceAll(/(^.{1,64})(.*$)/gmu,"$1"),n=1,a=t;for(;document.getElementById(a);)n++,a=t+"_"+n;e.setAttribute("id",a)}}function anchorFromHeader(e){navigator.clipboard.writeText(window.location.href.replaceAll(/(^[^#]*)(#.*)?$/gmu,"$1")+"#"+e.target.getAttribute("id")).then((function(){addSnackbar('Anchor link for "'+e.target.textContent+'" copied to clipboard',"success")}),(function(){addSnackbar('Failed to copy anchor link for "'+e.target.textContent+'"',"failure")}))}function signInUpInit(){document.querySelectorAll(".showpassword").forEach((e=>{e.addEventListener("click",showPassToggle)})),document.querySelectorAll("#radio_signinup input[type=radio]").forEach((e=>{e.addEventListener("change",loginRadioCheck)})),loginRadioCheck()}const emailRegex="[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*",userRegex="[^\\/\\\\\\[\\]:;|=$%#@&\\(\\)\\{\\}!,+*?<>\\0\\t\\r\\n\\x00-\\x1F\\x7F\\x0b\\f\\x85\\v\\cY\\b]{1,64}";function showPassToggle(e){e.preventDefault();let t=e.target,n=t.parentElement.getElementsByTagName("input").item(0);"password"===n.type?(n.type="text",t.title="Hide password"):(n.type="password",t.title="Show password")}function passwordStrengthOnEvent(e){let t=e.target.parentElement.querySelectorAll(".password_strength").item(0),n=passwordStrength(e.target.value);t.innerHTML=n,t.classList.remove("password_weak","password_medium","password_strong","password_very_strong"),"very strong"===n?t.classList.add("password_very_strong"):t.classList.add("password_"+n)}function passwordStrength(e,t=[]){let n=0;return!0===/.{8,}/u.test(e)&&n++,!0===/.{16,}/u.test(e)&&n++,!0===/.{32,}/u.test(e)&&n++,!0===/.{64,}/u.test(e)&&n++,!0===/\p{Ll}/u.test(e)&&n++,!0===/\p{Lu}/u.test(e)&&n++,!0===/\p{Lo}/u.test(e)&&n++,!0===/\p{N}/u.test(e)&&n++,!0===/[\p{P}\p{S}]/u.test(e)&&n++,!0===/(.)\1{2,}/u.test(e)&&n--,n<=2?"weak":2<n&&n<5?"medium":5<n&&n<9?"very strong":5===n?"strong":void 0}function loginRadioCheck(){let e=document.getElementById("radio_existuser"),t=document.getElementById("radio_newuser"),n=document.getElementById("radio_forget"),a=document.getElementById("signinup_email"),r=document.getElementById("signinup_password"),o=document.getElementById("signinup_submit"),i=document.getElementById("rememberme");e&&!0===e.checked&&(r.required=!0,r.setAttribute("autocomplete","current-password"),a.setAttribute("type","text"),a.setAttribute("autocomplete","username"),a.setAttribute("pattern","^("+userRegex+")|("+emailRegex+")$"),r.setAttribute("minlength","8"),o.value="Sign in",["focus","change","input"].forEach((function(e){r.removeEventListener(e,passwordStrengthOnEvent)})),r.parentElement.classList.remove("hidden"),i.parentElement.classList.remove("hidden"),document.getElementById("password_req").classList.add("hidden"),document.querySelectorAll(".pass_str_div").item(0).classList.add("hidden")),t&&!0===t.checked&&(r.required=!0,r.setAttribute("autocomplete","new-password"),a.setAttribute("autocomplete","email"),a.setAttribute("pattern","^"+emailRegex+"$"),r.setAttribute("minlength","8"),o.value="Join",["focus","change","input"].forEach((function(e){r.addEventListener(e,passwordStrengthOnEvent)})),r.parentElement.classList.remove("hidden"),i.parentElement.classList.remove("hidden"),document.getElementById("password_req").classList.remove("hidden"),document.querySelectorAll(".pass_str_div").item(0).classList.remove("hidden")),n&&!0===n.checked&&(r.required=!1,r.removeAttribute("autocomplete"),a.setAttribute("type","text"),a.setAttribute("autocomplete","username"),a.setAttribute("pattern","^("+userRegex+")|("+emailRegex+")$"),r.removeAttribute("minlength"),o.value="Remind",["focus","change","input"].forEach((function(e){r.removeEventListener(e,passwordStrengthOnEvent)})),r.parentElement.classList.add("hidden"),i.parentElement.classList.add("hidden"),document.getElementById("password_req").classList.add("hidden"),document.querySelectorAll(".pass_str_div").item(0).classList.add("hidden"),i.checked=!1),r&&ariaNation(r)}let notificationIndex=0;function addSnackbar(e,t="text",n=3e3){const a=document.getElementById("snacksContainer");let r=document.createElement("dialog"),o=notificationIndex++;r.setAttribute("id","snackbar"+o),r.setAttribute("role","alert"),r.classList.add("snackbar"),r.innerHTML='<span class="snack_text">'+e+'</span><input id="closeSnack'+o+'" class="navIcon snack_close" alt="Close notification" type="image" src="/img/close.svg" aria-invalid="false" placeholder="image">',r.classList.add(t),a.appendChild(r),r.classList.add("fadeIn"),document.getElementById("closeSnack"+o).addEventListener("click",(function(){removeSnack(r)})),n>0&&setTimeout((function(){removeSnack(r)}),n)}function removeSnack(e){const t=document.getElementById("snacksContainer");e.classList.remove("fadeIn"),e.classList.add("fadeOut"),e.addEventListener("animationend",(function(){t.removeChild(e)}))}function tooltipInit(){tabForTips(),document.onmousemove=function(e){tooltip(e.target);let t=e.clientX,n=e.clientY;document.documentElement.style.setProperty("--cursorX",t+"px"),document.documentElement.style.setProperty("--cursorY",n+"px")},document.querySelectorAll("[data-tooltip]").forEach((e=>{e.addEventListener("focus",(function(e){tooltip(e.target);let t=e.target.getBoundingClientRect(),n=document.getElementById("tooltip"),a=t.x,r=t.y-1.5*n.offsetHeight;document.documentElement.style.setProperty("--cursorX",a+"px"),document.documentElement.style.setProperty("--cursorY",r+"px")}))})),document.querySelectorAll(":not([data-tooltip])").forEach((e=>{e.addEventListener("focus",(function(){document.getElementById("tooltip").removeAttribute("data-tooltip")}))}))}function tabForTips(){document.querySelectorAll("[data-tooltip]:not([tabindex])").forEach((e=>{e.setAttribute("tabindex","0")}))}function tooltip(e){let t=e.parentElement,n=document.getElementById("tooltip");e.hasAttribute("data-tooltip")||t.hasAttribute("data-tooltip")?n.setAttribute("data-tooltip",e.getAttribute("data-tooltip")??t.getAttribute("data-tooltip")):n.removeAttribute("data-tooltip")}function webShareInit(){navigator.share?(document.getElementById("shareButton").classList.remove("hidden"),document.getElementById("shareButton").addEventListener("click",webShare)):document.getElementById("shareButton").classList.add("hidden")}function webShare(){navigator.share({title:document.title,text:getMeta("og:description")??getMeta("description"),url:document.location})}
//# sourceMappingURL=js.map