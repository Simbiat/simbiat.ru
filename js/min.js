"use strict";async function ajax(e,t=null,s="json",i="GET",n=6e4,a=!1){let r,o=new AbortController;setTimeout((()=>o.abort()),n);try{let n=await fetch(e,{method:i,mode:"same-origin",cache:"no-cache",credentials:"same-origin",headers:{"X-CSRF-Token":getMeta("X-CSRF-Token")??""},redirect:"error",referrer:window.location.href,referrerPolicy:"same-origin",keepalive:!1,signal:o.signal,body:["POST","PUT","DELETE","PATCH"].includes(i)?t:null});return n.ok||a?(r="json"===s?await n.json():"blob"===s?await n.blob():"array"===s?await n.arrayBuffer():"form"===s?await n.formData():await n.text(),r):(new Snackbar('Request to "'+e+'" returned code '+n.status,"failure",1e4),!1)}catch(t){"AbortError"===t.name?new Snackbar('Request to "'+e+'" timed out after '+n+" milliseconds","failure",1e4):new Snackbar('Request to "'+e+'" failed on fetch operation',"failure",1e4)}}function getMeta(e){let t=Array.from(document.getElementsByTagName("meta")).find((t=>t.name===e));return t?t.getAttribute("content"):null}function updateHistory(e,t){document.title=t,window.history.pushState(t,t,e)}function submitIntercept(e,t){e.addEventListener("submit",(function(e){return e.preventDefault(),e.stopPropagation(),t(),!1})),e.addEventListener("keydown",(function(e){return"Enter"!==e.code||(e.preventDefault(),e.stopPropagation(),t(),!1)}))}const pageTitle=" on Simbiat Software",emailRegex="[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*",userRegex="[^\\/\\\\\\[\\]:;|=$%#@&\\(\\)\\{\\}!,+*?<>\\0\\t\\r\\n\\x00-\\x1F\\x7F\\x0b\\f\\x85\\v\\cY\\b]{1,64}";function init(){new Input,new Textarea,new Form,new Details,new Quotes,new Aside,new Nav,new Headings,customElements.define("back-to-top",BackToTop),customElements.define("time-r",Timer),customElements.define("web-share",WebShare),customElements.define("tool-tip",Tooltip),customElements.define("snack-close",SnackbarClose),customElements.define("gallery-overlay",Gallery),customElements.define("image-carousel",CarouselList),customElements.define("password-show",PasswordShow),customElements.define("password-requirements",PasswordRequirements),customElements.define("password-strength",PasswordStrength),new A,cleanGET(),hashCheck(),router()}function cleanGET(){let e=new URL(document.location.href),t=new URLSearchParams(e.search);t.delete("cacheReset"),""===t.toString()?window.history.replaceState(document.title,document.title,location.pathname+location.hash):window.history.replaceState(document.title,document.title,"?"+t+location.hash)}function hashCheck(){let e=new URL(document.location.href).hash,t=document.getElementsByTagName("gallery-overlay")[0];if(new RegExp("#gallery=\\d+","ui").test(e)){let s=Number(e.replace(/(#gallery=)(\d+)/iu,"$2"));s&&(t.images[s-1]?t.current=s-1:(new Snackbar("Image number "+s+" not found on page","failure"),window.history.replaceState(document.title,document.title,document.location.href.replace(e,""))))}else t.close()}function router(){let e=new URL(document.location.href).pathname.replace(/(\/)(.*)(\/)/iu,"$2").toLowerCase().split("/");e[0]&&("bictracker"===e[0]?e[1]&&("keying"===e[1]?new bicKeying:"search"===e[1]&&new bicRefresh):"fftracker"===e[0]?e[1]&&"track"===e[1]&&new ffTrack:"uc"===e[0]&&e[1]&&("emails"===e[1]?new Emails:"password"===e[1]&&new PasswordChange))}document.addEventListener("DOMContentLoaded",init),window.addEventListener("hashchange",(function(){hashCheck()}));class BackToTop extends HTMLElement{static content;static BTTs;constructor(){super(),BackToTop.content||(BackToTop.content=document.getElementById("content"),BackToTop.BTTs=Array.from(document.getElementsByTagName("back-to-top")),BackToTop.content.addEventListener("scroll",this.toggleButtons.bind(this))),this.addEventListener("click",(()=>{BackToTop.content.scrollTop=0}))}toggleButtons(){BackToTop.BTTs&&(0===BackToTop.content.scrollTop?BackToTop.BTTs.forEach((e=>{e.classList.add("hidden")})):BackToTop.BTTs.forEach((e=>{e.classList.remove("hidden")})))}}class Gallery extends HTMLElement{_current=0;images=[];get current(){return this._current}set current(e){e<0?this._current=this.images.length-1:e>this.images.length-1?this._current=0:this._current=e,(this.images.length>1||this.classList.contains("hidden"))&&this.open()}constructor(){super(),this.images=Array.from(document.querySelectorAll(".galleryZoom")),this.images.length>0&&(customElements.define("gallery-close",GalleryClose),customElements.define("gallery-prev",GalleryPrev),customElements.define("gallery-next",GalleryNext),customElements.define("gallery-image",GalleryImage),this.images.forEach(((e,t)=>{e.addEventListener("click",(e=>(e.preventDefault(),e.stopPropagation(),this.current=t,!1)))})),this.addEventListener("keydown",this.keyNav.bind(this)))}open(){this.tabIndex=99;let e=this.images[this.current],t=e.getElementsByTagName("img")[0],s=e.parentElement.getElementsByTagName("figcaption")[0],i=e.getAttribute("data-tooltip")??e.getAttribute("title")??t.getAttribute("alt")??e.href.replace(/^.*[\\\/]/u,"");document.getElementById("galleryName").innerHTML=s?s.innerHTML:i,document.getElementById("galleryNameLink").href=document.getElementById("galleryLoadedImage").src=e.href,document.getElementById("galleryTotal").innerText=this.images.length.toString(),document.getElementById("galleryCurrent").innerText=(this.current+1).toString(),this.classList.remove("hidden"),this.history(),this.focus()}close(){this.tabIndex=-1,this.classList.add("hidden"),this.history(),document.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0].focus()}previous(){this.current--}next(){this.current++}keyNav(e){return e.stopPropagation(),["ArrowDown","ArrowRight","PageDown"].includes(e.code)?(this.next(),!1):["ArrowUp","ArrowLeft","PageUp"].includes(e.code)?(this.previous(),!1):"End"===e.code?(this.current=this.images.length-1,!1):"Home"===e.code?(this.current=0,!1):!["Escape","Backspace"].includes(e.code)||(this.close(),!1)}history(){const e=new URL(document.location.href),t=(this.current+1).toString(),s=new RegExp("(.+"+pageTitle+")(, Image \\d+)?","ui");let i,n;this.classList.contains("hidden")?(n=document.title.replace(/(.*)(, Image )(\d+)/iu,"$1"),i=document.location.href.replace(e.hash,"")):(n=document.title.replace(s,"$1, Image "+t),i=document.location.href.replace(/([^#]+)((#gallery=\d+)|$)/iu,"$1#gallery="+t)),e!==new URL(i)&&updateHistory(i,n)}}class GalleryImage extends HTMLElement{image;constructor(){super(),this.image=document.getElementById("galleryLoadedImage"),this.image.addEventListener("load",this.checkZoom.bind(this))}checkZoom(){this.image.naturalHeight<=this.image.height?(this.image.classList.add("noZoom"),this.image.removeEventListener("click",this.zoom.bind(this))):(this.image.classList.remove("noZoom"),this.image.addEventListener("click",this.zoom.bind(this)))}zoom(){this.image.classList.contains("zoomedIn")?this.image.classList.remove("zoomedIn"):this.image.classList.add("zoomedIn")}}class GalleryPrev extends HTMLElement{overlay;constructor(){super(),this.overlay=document.getElementsByTagName("gallery-overlay")[0],this.overlay.images.length>1?this.addEventListener("click",(()=>{this.overlay.previous()})):this.classList.add("disabled")}}class GalleryNext extends HTMLElement{overlay;constructor(){super(),this.overlay=document.getElementsByTagName("gallery-overlay")[0],this.overlay.images.length>1?this.addEventListener("click",(()=>{this.overlay.next()})):this.classList.add("disabled")}}class GalleryClose extends HTMLElement{constructor(){super(),this.addEventListener("click",(()=>{document.getElementsByTagName("gallery-overlay")[0].close()}))}}class CarouselList extends HTMLElement{list;next;previous;maxScroll=0;constructor(){super(),this.list=this.getElementsByClassName("imageCarouselList")[0],this.next=this.getElementsByClassName("imageCarouselNext")[0],this.previous=this.getElementsByClassName("imageCarouselPrev")[0],this.list&&this.next&&this.previous&&(this.maxScroll=this.list.scrollWidth-this.list.offsetWidth,this.list.addEventListener("scroll",(()=>{this.disableScroll()})),[this.next,this.previous].forEach((e=>{e.addEventListener("click",(e=>{this.toScroll(e)}))})),this.disableScroll())}toScroll(e){let t=e.target,s=this.list.getElementsByTagName("img")[0].width;t.classList.contains("imageCarouselPrev")?this.list.scrollLeft-=s:this.list.scrollLeft+=s,this.disableScroll()}disableScroll(){0===this.list.scrollLeft?this.previous.classList.add("disabled"):this.previous.classList.remove("disabled"),this.list.scrollLeft>=this.maxScroll?this.next.classList.add("disabled"):this.next.classList.remove("disabled")}}class PasswordShow extends HTMLElement{passwordInput;constructor(){super(),this.passwordInput=this.parentElement.getElementsByTagName("input").item(0),this.addEventListener("click",this.toggle)}toggle(e){e.preventDefault(),"password"===this.passwordInput.type?(this.passwordInput.type="text",this.title="Hide password"):(this.passwordInput.type="password",this.title="Show password")}}class PasswordRequirements extends HTMLElement{passwordInput;constructor(){super(),this.classList.add("hidden"),this.innerHTML="Only password requirement: at least 8 symbols",this.passwordInput=this.parentElement.getElementsByTagName("input").item(0),this.passwordInput.addEventListener("focus",this.show.bind(this)),this.passwordInput.addEventListener("focusout",this.hide.bind(this)),["focus","change","input"].forEach((e=>{this.passwordInput.addEventListener(e,this.validate.bind(this))}))}validate(){this.passwordInput.validity.valid?(this.classList.remove("error"),this.classList.add("success")):(this.classList.add("error"),this.classList.remove("success"))}show(){"new-password"===(this.passwordInput.getAttribute("autocomplete")??null)?this.classList.remove("hidden"):this.classList.add("hidden")}hide(){this.classList.add("hidden")}}class PasswordStrength extends HTMLElement{passwordInput;strengthSpan;constructor(){super(),this.classList.add("hidden"),this.innerHTML='New password strength: <span class="password_strength">weak</span>',this.passwordInput=this.parentElement.getElementsByTagName("input").item(0),this.strengthSpan=this.getElementsByTagName("span")[0],this.passwordInput.addEventListener("focus",this.show.bind(this)),this.passwordInput.addEventListener("focusout",this.hide.bind(this)),["focus","change","input"].forEach((e=>{this.passwordInput.addEventListener(e,this.calculate.bind(this))}))}calculate(){let e=this.passwordInput.value,t=0;/.{8,}/u.test(e)&&t++,/.{16,}/u.test(e)&&t++,/.{32,}/u.test(e)&&t++,/.{64,}/u.test(e)&&t++,/\p{Ll}/u.test(e)&&t++,/\p{Lu}/u.test(e)&&t++,/\p{Lo}/u.test(e)&&t++,/\p{N}/u.test(e)&&t++,/[\p{P}\p{S}]/u.test(e)&&t++,/(.)\1{2,}/u.test(e)&&t--;let s="weak";return s=t<=2?"weak":2<t&&t<5?"medium":5===t?"strong":"very strong",this.strengthSpan.innerHTML=s,this.strengthSpan.classList.remove("password_weak","password_medium","password_strong","password_very_strong"),"very strong"===s?this.strengthSpan.classList.add("password_very_strong"):this.strengthSpan.classList.add("password_"+s),s}show(){"new-password"===(this.passwordInput.getAttribute("autocomplete")??null)?this.classList.remove("hidden"):this.classList.add("hidden")}hide(){this.classList.add("hidden")}}class Snackbar{snacks;static notificationIndex=0;constructor(e,t="",s=3e3){if(this.snacks=document.getElementsByTagName("snack-bar")[0],this.snacks){let i=document.createElement("dialog"),n=Snackbar.notificationIndex++;i.setAttribute("id","snackbar"+n),i.setAttribute("role","alert"),i.classList.add("snackbar"),i.innerHTML='<span class="snack_text">'+e+'</span><snack-close data-close-in="'+s+'"><input class="navIcon snack_close" alt="Close notification" type="image" src="/img/close.svg" aria-invalid="false" placeholder="image"></snack-close>',i.querySelectorAll('a[target="_blank"]').forEach((e=>{(new A).newTabStyle(e)})),t&&i.classList.add(t),this.snacks.appendChild(i),i.classList.add("fadeIn")}}}class SnackbarClose extends HTMLElement{snackbar;snack;constructor(){super(),this.snack=this.parentElement,this.snackbar=document.getElementsByTagName("snack-bar")[0],this.addEventListener("click",this.close);let e=parseInt(this.getAttribute("data-close-in")??"0");e>0&&setTimeout((()=>{this.close()}),e)}close(){this.snack.classList.remove("fadeIn"),this.snack.classList.add("fadeOut"),this.snack.addEventListener("animationend",(()=>{this.snack&&this.snackbar.removeChild(this.snack)}))}}class Timer extends HTMLElement{interval=null;constructor(){super(),this.interval=setInterval((()=>{parseInt(this.innerHTML)>0||Boolean(this.getAttribute("data-negative"))?Boolean(this.getAttribute("data-increase"))?this.innerHTML=String(parseInt(this.innerHTML)+1):this.innerHTML=String(parseInt(this.innerHTML)-1):(clearInterval(Number(this.interval)),"refresh_timer"===this.id&&location.reload())}),1e3)}}class Tooltip extends HTMLElement{x=0;y=0;constructor(){super(),document.querySelectorAll('[alt]:not([alt=""]):not([data-tooltip]), [title]:not([title=""]):not([data-tooltip])').forEach((e=>{e.parentElement.hasAttribute("data-tooltip")||e.setAttribute("data-tooltip",e.getAttribute("alt")??e.getAttribute("title")??"")})),document.querySelectorAll("[data-tooltip]:not([tabindex])").forEach((e=>{e.setAttribute("tabindex","0")})),document.addEventListener("mousemove",this.onMouseMove.bind(this)),document.querySelectorAll('[data-tooltip]:not([data-tooltip=""])').forEach((e=>{e.addEventListener("focus",this.onFocus.bind(this))})),document.querySelectorAll(":not([data-tooltip])").forEach((e=>{e.addEventListener("focus",(()=>{this.removeAttribute("data-tooltip")}))}))}onMouseMove(e){this.update(e.target),this.x=e.clientX,this.y=e.clientY,this.tooltipCursor()}onFocus(e){this.update(e.target);let t=e.target.getBoundingClientRect();this.x=t.x,this.y=t.y-1.5*this.offsetHeight,this.tooltipCursor()}tooltipCursor(){this.y+this.offsetHeight>window.innerHeight&&(this.y=window.innerHeight-2*this.offsetHeight),this.x+this.offsetWidth>window.innerWidth&&(this.x=window.innerWidth-1.5*this.offsetWidth),document.documentElement.style.setProperty("--cursorX",this.x+"px"),document.documentElement.style.setProperty("--cursorY",this.y+"px")}update(e){let t=e.parentElement,s=e.getAttribute("data-tooltip")??t.getAttribute("data-tooltip")??null;s&&matchMedia("(pointer:fine)").matches?this.setAttribute("data-tooltip",s):this.removeAttribute("data-tooltip")}}class WebShare extends HTMLElement{constructor(){super(),void 0!==navigator.share?(this.classList.remove("hidden"),this.addEventListener("click",this.share)):this.classList.add("hidden")}share(){return navigator.share({title:document.title,text:getMeta("og:description")??getMeta("description")??"",url:document.location.href})}}class A{static _instance=null;constructor(){if(A._instance)return A._instance;document.querySelectorAll('a[target="_blank"]').forEach((e=>{this.newTabStyle(e)})),A._instance=this}newTabStyle(e){e.innerHTML.includes("img/newtab.svg")||e.classList.contains("galleryZoom")||e.classList.contains("footerLink")||(e.innerHTML+='<img class="newTabIcon" src="/img/newtab.svg" alt="Opens in new tab">')}}class Aside{static _instance=null;sidebarDiv=null;loginForm=null;constructor(){if(Aside._instance)return Aside._instance;this.sidebarDiv=document.getElementById("sidebar"),document.getElementById("showSidebar").addEventListener("click",(()=>{this.sidebarDiv.classList.add("shown")})),document.getElementById("hideSidebar").addEventListener("click",(()=>{this.sidebarDiv.classList.remove("shown")})),this.loginForm=document.getElementById("signinup"),this.loginForm&&(this.loginForm.querySelectorAll("#radio_signinup input[type=radio]").forEach((e=>{e.addEventListener("change",this.loginRadioCheck)})),this.loginRadioCheck(),submitIntercept(this.loginForm,this.singInUpSubmit.bind(this))),Aside._instance=this}singInUpSubmit(){if(this.loginForm){let e=new FormData(this.loginForm);e.get("signinup[type]")||e.set("signinup[type]","logout"),e.set("signinup[timezone]",Intl.DateTimeFormat().resolvedOptions().timeZone);let t=document.getElementById("signinup_spinner");t.classList.remove("hidden"),ajax(location.protocol+"//"+location.host+"/api/uc/signinup/"+e.get("signinup[type]")+"/",e,"json","POST",6e4,!0).then((s=>{!0===s.data?"remind"===e.get("signinup[type]")?new Snackbar("If respective account is registered an email has been sent with password reset link.","success"):location.reload():new Snackbar(s.reason,"failure",1e4),t.classList.add("hidden")}))}}loginRadioCheck(){let e,t=document.getElementById("radio_existuser"),s=document.getElementById("radio_newuser"),i=document.getElementById("radio_forget"),n=document.getElementById("signinup_email");n&&n.labels&&(e=n.labels[0]);let a=document.getElementById("signinup_password"),r=document.getElementById("signinup_submit"),o=document.getElementById("rememberme"),l=document.getElementById("signinup_username");t&&t.checked&&(a.required=!0,a.setAttribute("autocomplete","current-password"),n.setAttribute("type","email"),n.setAttribute("autocomplete","email"),n.setAttribute("pattern","^"+emailRegex+"$"),a.setAttribute("minlength","8"),r.value="Sign in",a.parentElement.classList.remove("hidden"),o.parentElement.classList.remove("hidden"),l.parentElement.classList.add("hidden"),l.required=!1),s&&s.checked&&(a.required=!0,a.setAttribute("autocomplete","new-password"),n.setAttribute("type","email"),n.setAttribute("autocomplete","email"),n.setAttribute("pattern","^"+emailRegex+"$"),a.setAttribute("minlength","8"),r.value="Join",a.parentElement.classList.remove("hidden"),o.parentElement.classList.remove("hidden"),n.placeholder="Email",e&&(e.innerHTML="Email"),l.parentElement.classList.remove("hidden"),l.required=!0),i&&i.checked&&(a.required=!1,a.removeAttribute("autocomplete"),n.setAttribute("type","text"),n.setAttribute("autocomplete","username"),n.setAttribute("pattern","^("+userRegex+")|("+emailRegex+")$"),a.removeAttribute("minlength"),r.value="Remind",a.parentElement.classList.add("hidden"),o.parentElement.classList.add("hidden"),o.checked=!1,n.placeholder="Email or name",e&&(e.innerHTML="Email or name"),l.parentElement.classList.add("hidden"),l.required=!1),a&&(new Input).ariaNation(a)}}class Details{static list;static _instance=null;constructor(){if(Details._instance)return Details._instance;Details.list=Array.from(document.getElementsByTagName("details")),Details.list.forEach(((e,t,s)=>{e.ontoggle=t=>{e.open&&!e.classList.contains("persistent")&&s.forEach((t=>{t===e||t.classList.contains("persistent")||(t.open=!1)}))}})),Details.list.forEach((e=>{e.addEventListener("click",(e=>{this.reset(e.target)}))})),Details._instance=this}reset(e){Details.list.forEach((t=>{t.open&&t!==e&&!t.contains(e)?t.open=!1:t.classList.contains("popup")&&document.addEventListener("click",(e=>{this.clickOutsideDetails(e,t)}))}))}clickOutsideDetails(e,t){t===e.target||t.contains(e.target)||(t.open=!1,document.removeEventListener("click",(e=>{this.clickOutsideDetails(e,t)})))}}class Form{static _instance=null;constructor(){if(Form._instance)return Form._instance;document.querySelectorAll("form").forEach((e=>{e.addEventListener("keypress",(e=>{this.formEnter(e)}))})),document.querySelectorAll("form[data-baseURL] input[type=search]").forEach((e=>{e.addEventListener("input",this.searchAction.bind(this)),e.addEventListener("change",this.searchAction.bind(this)),e.addEventListener("focus",this.searchAction.bind(this))})),document.querySelectorAll('form input[type="email"], form input[type="password"], form input[type="search"], form input[type="tel"], form input[type="text"], form input[type="url"]').forEach((e=>{e.addEventListener("keydown",this.inputBackSpace.bind(this)),e.getAttribute("maxlength")&&(e.addEventListener("input",this.autoNext.bind(this)),e.addEventListener("change",this.autoNext.bind(this)),e.addEventListener("paste",this.pasteSplit.bind(this)))})),Form._instance=this}formEnter(e){let t=e.target.form;if(!("Enter"!==e.code&&"NumpadEnter"!==e.code||t.action&&t.getAttribute("data-baseURL")&&location.protocol+"//"+location.host+t.getAttribute("data-baseURL")!==t.action))return e.stopPropagation(),e.preventDefault(),!1}searchAction(e){let t=e.target,s=t.form;""===t.value?s.action=String(s.getAttribute("data-baseURL")):s.action=s.getAttribute("data-baseURL")+this.rawurlencode(t.value),s.method="get"}rawurlencode(e){return e+="",encodeURIComponent(e).replace(/!/gu,"%21").replace(/'/gu,"%27").replace(/\(/gu,"%28").replace(/\)/gu,"%29").replace(/\*/gu,"%2A")}inputBackSpace(e){let t=e.target;if("Backspace"===e.code&&!t.value){let e=this.nextInput(t,!0);e&&(e.focus(),e.selectionStart=e.selectionEnd=e.value.length)}}autoNext(e){let t=e.target,s=parseInt(t.getAttribute("maxlength")??"0");if(s&&t.value.length===s&&t.validity.valid){let e=this.nextInput(t,!1);e&&e.focus()}}nextInput(e,t=!1){let s=e.form;if(s){let i;for(let n of s.querySelectorAll("input")){if(t){if(n===e)return i||!1}else if(i&&i===e)return n;i=n}}return!1}async pasteSplit(e){let t=await navigator.permissions.query({name:"clipboard-read"}).catch((()=>{console.error("Your browser does not support clipboard-read permission.")}));t&&"denied"!==t.state&&navigator.clipboard.readText().then((t=>{let s=t.toString(),i=e.target,n=parseInt(i.getAttribute("maxlength")??"0");for(;i&&n&&s.length>n;){if(i.value=s.substring(0,n),i.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),!i.validity.valid)return!1;s=s.substring(n),i=this.nextInput(i,!1),i&&(i.focus(),n=parseInt(i.getAttribute("maxlength")??"0"))}return i&&(i.value=s,i.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))),!0}))}}class Headings{static _instance=null;constructor(){if(Headings._instance)return Headings._instance;document.querySelectorAll("h1:not(#h1title), h2, h3, h4, h5, h6").forEach((e=>{if(!e.hasAttribute("id")){let t=String(e.textContent).replaceAll(/\s/gmu,"_").replaceAll(/[^\p{L}\p{N}_\-]/gmu,"").replaceAll(/(^.{1,64})(.*$)/gmu,"$1"),s=1,i=t;for(;document.getElementById(i);)s++,i=t+"_"+s;e.setAttribute("id",i)}e.addEventListener("click",(e=>{this.copyLink(e.target)}))})),Headings._instance=this}copyLink(e){if("Range"!==window.getSelection().type){let t=window.location.href.replaceAll(/(^[^#]*)(#.*)?$/gmu,"$1")+"#"+e.getAttribute("id");return navigator.clipboard.writeText(t).then((function(){new Snackbar('Anchor link for "'+e.textContent+'" copied to clipboard',"success")}),(function(){new Snackbar('Failed to copy anchor link for "'+e.textContent+'"',"failure")})),t}return""}}class Input{static _instance=null;constructor(){if(Input._instance)return Input._instance;Array.from(document.getElementsByTagName("input")).forEach((e=>{this.init(e)})),Input._instance=this}init(e){e.addEventListener("focus",(()=>{this.ariaNation(e)})),e.addEventListener("change",(()=>{this.ariaNation(e)})),e.addEventListener("input",(()=>{this.ariaNation(e)})),this.ariaNation(e)}ariaNation(e){e.setAttribute("aria-invalid",String(!e.validity.valid)),e.hasAttribute("placeholder")||e.setAttribute("placeholder",e.value||e.type||"placeholder"),e.getAttribute("type")||e.setAttribute("type","text");let t=e.type??e.getAttribute("type")??"text";["text","search","url","tel","email","password","date","month","week","time","datetime-local","number","checkbox","radio","file"].includes(String(t))&&(e.required?e.setAttribute("aria-required",String(!0)):e.setAttribute("aria-required",String(!1))),"checkbox"===t&&(e.setAttribute("role","checkbox"),e.setAttribute("aria-checked",String(e.checked)),e.indeterminate&&e.setAttribute("aria-checked","mixed")),"checkbox"===t&&e.setAttribute("value",e.value)}}class Nav{static _instance=null;navDiv=null;constructor(){if(Nav._instance)return Nav._instance;this.navDiv=document.getElementById("navigation"),document.getElementById("showNav").addEventListener("click",(()=>{this.navDiv.classList.add("shown")})),document.getElementById("hideNav").addEventListener("click",(()=>{this.navDiv.classList.remove("shown")})),Nav._instance=this}}class Quotes{static _instance=null;constructor(){if(Quotes._instance)return Quotes._instance;document.querySelectorAll("samp, code, blockquote").forEach((e=>{e.innerHTML='<img loading="lazy" decoding="async"  src="/img/copy.svg" alt="Click to copy block" class="copyQuote">'+e.innerHTML})),Array.from(document.getElementsByTagName("q")).forEach((e=>{e.setAttribute("data-tooltip","Click to copy quote")})),document.querySelectorAll(".copyQuote, q").forEach((e=>{e.addEventListener("click",(e=>{this.copy(e.target)}))})),Quotes._instance=this}copy(e){let t;switch("q"!==e.tagName.toLowerCase()&&(e=e.parentElement),e.tagName.toLowerCase()){case"samp":t="Sample";break;case"code":t="Code";break;case"blockquote":case"q":t="Quote"}return navigator.clipboard.writeText(String(e.textContent)).then((function(){new Snackbar(t+" copied to clipboard","success")}),(function(){new Snackbar("Failed to copy "+t.toLowerCase(),"failure")})),String(e.textContent)}}class Textarea{static _instance=null;constructor(){if(Textarea._instance)return Textarea._instance;Array.from(document.getElementsByTagName("textarea")).forEach((e=>{e.hasAttribute("placeholder")||e.setAttribute("placeholder",e.value||e.type||"placeholder")})),Textarea._instance=this}}class bicKeying{constructor(){document.getElementById("bic_key").addEventListener("input",(()=>{this.calc()})),document.getElementById("account_key").addEventListener("input",(()=>{this.calc()}))}calc(){let e=document.getElementById("bic_keying"),t=new FormData(e),s=document.getElementById("accCheckResult"),i=String(t.get("bic_key")),n=String(t.get("account_key")),a=document.getElementById("bic_key_sample"),r=document.getElementById("account_key_sample");if(s.classList.remove(...s.classList),null===/^\d{9}$/u.exec(i))return s.classList.add("failure"),s.innerHTML="Неверный формат БИКа",void this.styleBic(a,"warning","БИК");if(this.styleBic(a,"success",i),null===/^\d{5}[\dАВСЕНКМРТХавсенкмртх]\d{14}$/u.exec(n))return s.classList.add("failure"),s.innerHTML="Неверный формат счёта",void this.styleBic(r,"warning","СЧЁТ");this.styleBic(r,"success",n),updateHistory(location.protocol+"//"+location.host+"/bictracker/keying/"+i+"/"+n+"/","Ключевание счёта "+n+pageTitle),s.classList.add("warning"),s.innerHTML="Проверяем...";let o=document.getElementById("bic_spinner");o.classList.remove("hidden"),ajax(location.protocol+"//"+location.host+"/api/bictracker/keying/",t,"json","POST",6e4,!0).then((e=>{s.classList.remove(...s.classList),!0===e.data?(s.classList.add("success"),s.innerHTML="Правильное ключевание"):(s.classList.add("failure"),!1===e.data?s.innerHTML="Непредвиденная ошибка":s.innerHTML="Неверное ключевание. Ожидаемый ключ: "+e.data+" ("+n.replace(/(^\d{5}[\dАВСЕНКМРТХавсенкмртх]\d{2})(\d)(\d{11})$/u,'$1<span class="success">'+e.data+"</span>$3")+")"),o.classList.add("hidden")}))}styleBic(e,t,s=""){e.classList.remove(...e.classList),e.classList.add(t),e.innerHTML=s}}class bicRefresh{refreshButton;constructor(){this.refreshButton=document.getElementById("bicRefresh"),this.refreshButton.addEventListener("click",(e=>{this.refresh(e)}))}refresh(e){this.refreshButton.classList.contains("spin")?(e.stopPropagation(),e.preventDefault()):(this.refreshButton.classList.add("spin"),setTimeout((async()=>{await ajax(location.protocol+"//"+location.host+"/api/bictracker/dbupdate/",null,"json","PUT",3e5).then((t=>{if(!0===t.data)new Snackbar("Библиотека БИК обновлена","success"),this.refreshButton.classList.remove("spin");else if("number"==typeof t.data){let s=new Date(1e3*t.data),i=document.getElementsByClassName("bic_date")[0];i.setAttribute("datetime",s.toISOString()),i.innerHTML=("0"+String(s.getUTCDate())).slice(-2)+"."+("0"+String(s.getMonth()+1)).slice(-2)+"."+String(s.getUTCFullYear()),new Snackbar("Применено обновление за "+i.innerHTML,"success"),this.refreshButton.classList.remove("spin"),this.refresh(e)}else new Snackbar("Не удалось обновить библиотеку БИК","failure",1e4),this.refreshButton.classList.remove("spin")}))}),500))}}class ffTrack{select;idInput;constructor(){this.idInput=document.getElementById("ff_track_id"),this.select=document.getElementById("ff_track_type"),this.select.addEventListener("change",(()=>{this.typeChange()})),submitIntercept(document.getElementById("ff_track_register"),this.add.bind(this))}add(){let e,t=this.select.selectedOptions[0];if(e=t?t.text:"Character",this.idInput&&this.select){let t=document.getElementById("ff_track_spinner");t.classList.remove("hidden"),ajax(location.protocol+"//"+location.host+"/api/fftracker/"+this.select.value+"/"+this.idInput.value+"/",null,"json","POST",6e4,!0).then((s=>{!0===s.data?new Snackbar(e+" with ID "+this.idInput.value+' was registered. Check <a href="'+location.protocol+"//"+location.host+"/fftracker/"+this.select.value+"/"+this.idInput.value+'/" target="_blank">here</a>.',"success",0):"404"===s?new Snackbar(e+" with ID "+this.idInput.value+" was not found on Lodestone.","failure",1e4):s.reason.match(/^ID `.*` is already registered$/iu)?new Snackbar(s.reason+'. Check <a href="'+location.protocol+"//"+location.host+"/fftracker/"+this.select.value+"/"+this.idInput.value+'/" target="_blank">here</a>.',"warning",0):new Snackbar(s.reason,"failure",1e4),t.classList.add("hidden")}))}}typeChange(){let e="^\\d{1,20}$";"pvpteam"!==this.select.value&&"crossworld_linkshell"!==this.select.value||(e="^[0-9a-z]{40}$"),this.idInput.setAttribute("pattern",e)}}class Emails{addMailForm=null;constructor(){this.addMailForm=document.getElementById("addMailForm"),this.addMailForm&&(submitIntercept(this.addMailForm,this.add.bind(this)),document.querySelectorAll(".mail_activation").forEach((e=>{e.addEventListener("click",(e=>{this.activate(e.target)}))})),document.querySelectorAll("[id^=subscription_checkbox_]").forEach((e=>{e.addEventListener("click",(e=>{this.subscribe(e)}))})),document.querySelectorAll(".mail_deletion").forEach((e=>{e.addEventListener("click",(e=>{this.delete(e.target)}))})))}add(){let e=new FormData(this.addMailForm);if(!e.get("email"))return new Snackbar("Please, enter a valid email address","failure"),!1;let t=String(e.get("email")),s=document.getElementById("addMail_spinner");s.classList.remove("hidden"),ajax(location.protocol+"//"+location.host+"/api/uc/emails/add/",e,"json","POST",6e4,!0).then((e=>{if(!0===e.data){let e=document.getElementById("emailsList").insertRow();e.classList.add("middle");let s=e.insertCell();s.innerHTML=t,s=e.insertCell(),s.innerHTML='<input type="button" value="Confirm" class="mail_activation" data-email="'+t+'" aria-invalid="false" placeholder="Confirm"><img class="hidden spinner inline" src="/img/spinner.svg" alt="Activating '+t+'..." data-tooltip="Activating '+t+'...">',s=e.insertCell(),s.innerHTML="Confirm address to change setting",s.classList.add("warning"),s=e.insertCell(),s.innerHTML='<td><input class="mail_deletion" data-email="'+t+'" type="image" src="/img/close.svg" alt="Delete '+t+'" aria-invalid="false" placeholder="image" data-tooltip="Delete '+t+'" tabindex="0"><img class="hidden spinner inline" src="/img/spinner.svg" alt="Removing '+t+'..." data-tooltip="Removing '+t+'...">';let i=s.getElementsByTagName("input")[0];(new Input).init(i),e.querySelectorAll(".mail_activation").forEach((e=>{e.addEventListener("click",(e=>{this.activate(e.target)}))})),e.querySelectorAll("[id^=subscription_checkbox_]").forEach((e=>{e.addEventListener("click",(e=>{this.subscribe(e)}))})),e.querySelectorAll(".mail_deletion").forEach((e=>{e.addEventListener("click",(e=>{this.delete(e.target)}))})),this.blockDelete(),this.addMailForm.reset(),new Snackbar(t+" added","success")}else new Snackbar(e.reason,"failure",1e4);s.classList.add("hidden")}))}delete(e){let t=e.parentElement.parentElement.parentElement,s=e.parentElement.parentElement.rowIndex-1,i=e.parentElement.getElementsByClassName("spinner")[0],n=new FormData,a=e.getAttribute("data-email")??"";n.set("email",a),i.classList.remove("hidden"),ajax(location.protocol+"//"+location.host+"/api/uc/emails/delete/",n,"json","DELETE",6e4,!0).then((e=>{!0===e.data?(t.deleteRow(s),this.blockDelete(),new Snackbar(a+" removed","success")):new Snackbar(e.reason,"failure",1e4),i.classList.add("hidden")}))}blockDelete(){let e=document.getElementsByClassName("mail_confirmed").length;document.querySelectorAll(".mail_deletion").forEach((t=>{if(t.parentElement.parentElement.getElementsByClassName("mail_confirmed").length>0)t.disabled=e<2;else if(t.disabled=!1,t.getAttribute("data-tooltip")&&"Can't delete"===t.getAttribute("data-tooltip")){let e=t.parentElement.parentElement.getElementsByTagName("td")[0].innerHTML;t.setAttribute("data-tooltip","Delete "+e);let s=t.parentElement.getElementsByClassName("spinner")[0];s.setAttribute("data-tooltip","Removing "+e+"..."),s.setAttribute("alt","Removing "+e+"...")}}))}subscribe(e){e.preventDefault(),e.stopPropagation();let t,s=e.target;t=s.checked?"subscribe":"unsubscribe";let i=s.parentElement.getElementsByTagName("label")[0],n=s.parentElement.parentElement.getElementsByClassName("spinner")[0],a=s.getAttribute("data-email")??"",r=new FormData;r.set("verb",t),r.set("email",a),n.classList.remove("hidden"),ajax(location.protocol+"//"+location.host+"/api/uc/emails/"+t+"/",r,"json","PATCH",6e4,!0).then((e=>{!0===e.data?s.checked?(s.checked=!1,i.innerText="Subscribe",new Snackbar(a+" unsubscribed","success")):(s.checked=!0,i.innerText="Unsubscribe",new Snackbar(a+" subscribed","success")):new Snackbar(e.reason,"failure",1e4),n.classList.add("hidden")}))}activate(e){let t=e.parentElement.getElementsByClassName("spinner")[0],s=e.getAttribute("data-email")??"",i=new FormData;i.set("verb","activate"),i.set("email",s),t.classList.remove("hidden"),ajax(location.protocol+"//"+location.host+"/api/uc/emails/activate/",i,"json","PATCH",6e4,!0).then((e=>{!0===e.data?new Snackbar("Activation email sent to "+s,"success"):new Snackbar(e.reason,"failure",1e4),t.classList.add("hidden")}))}}class PasswordChange{form=null;constructor(){this.form=document.getElementById("password_change"),this.form&&submitIntercept(this.form,this.change.bind(this))}change(){let e=new FormData(this.form),t=document.getElementById("pw_change_spinner");t.classList.remove("hidden"),ajax(location.protocol+"//"+location.host+"/api/uc/password/",e,"json","PATCH",6e4,!0).then((e=>{!0===e.data?new Snackbar("Password changed","success"):new Snackbar(e.reason,"failure",1e4),t.classList.add("hidden")}))}}
//# sourceMappingURL=min.js.map