{"version":3,"file":"contacts.js","sourceRoot":"/js/Pages/","sources":["about/contacts.ts"],"names":[],"mappings":"AAAA,MAAM,OAAO,QAAQ;IACF,eAAe,GAA2B,IAAI,CAAC;IAEhE;QACE,IAAI,CAAC,eAAe,GAAG,QAAQ,CAAC,aAAa,CAAC,kBAAkB,CAAC,CAAC;QAClE,IAAI,IAAI,CAAC,eAAe,EAAE,CAAC;YACzB,eAAe,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACnE,CAAC;IACH,CAAC;IAEO,SAAS;QACf,IAAI,IAAI,CAAC,eAAe,EAAE,CAAC;YAEzB,MAAM,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,oBAAoB,CAAC,CAAC;YAExE,MAAM,SAAS,GAAG,IAAI,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;YAIrD,SAAS,CAAC,MAAM,CAAC,sBAAsB,EAAE,QAAQ,CAAC,CAAC;YACnD,YAAY,CAAC,MAA0B,CAAC,CAAC;YACzC,IAAI,CAAC,GAAG,QAAQ,CAAC,QAAQ,KAAK,QAAQ,CAAC,IAAI,cAAc,EAAE,SAAS,EAAE,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,IAAI,CAAC;iBACtG,IAAI,CAAC,CAAC,QAAQ,EAAE,EAAE;gBACjB,MAAM,IAAI,GAAG,QAA4B,CAAC;gBAC1C,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,EAAE,CAAC;oBACvB,IAAI,IAAI,CAAC,eAAe,EAAE,CAAC;wBAEzB,MAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;wBAChE,IAAI,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC;4BACpC,WAAW,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;wBAC3B,CAAC;oBACH,CAAC;oBACD,WAAW,CAAC,8BAA8B,EAAE,SAAS,CAAC,CAAC;oBACvD,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACnD,CAAC;qBAAM,CAAC;oBACN,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;wBAClB,WAAW,CAAC,IAAI,CAAC,MAAM,GAAG,6BAA6B,IAAI,CAAC,QAAQ,uDAAuD,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;oBAC7I,CAAC;yBAAM,CAAC;wBACN,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE,SAAS,EAAE,kBAAkB,CAAC,CAAC;oBAC1D,CAAC;gBACH,CAAC;gBACD,YAAY,CAAC,MAA0B,CAAC,CAAC;YAC3C,CAAC,CAAC,CAAC;QACP,CAAC;IACH,CAAC;CACF","sourcesContent":["export class Contacts {\r\n  private readonly add_thread_form: HTMLFormElement | null = null;\r\n\r\n  public constructor() {\r\n    this.add_thread_form = document.querySelector('#add_thread_form');\r\n    if (this.add_thread_form) {\r\n      submitIntercept(this.add_thread_form, this.addThread.bind(this));\r\n    }\r\n  }\r\n\r\n  private addThread(): void {\r\n    if (this.add_thread_form) {\r\n      //Get submit button\r\n      const button = this.add_thread_form.querySelector('input[type=submit]');\r\n      //Get form data\r\n      const form_data = new FormData(this.add_thread_form);\r\n      //Check if custom icon is being attached\r\n      //form_data.append('new_thread[og_image]', 'false');\r\n      //Add time zone\r\n      form_data.append('new_thread[timezone]', TIMEZONE);\r\n      buttonToggle(button as HTMLInputElement);\r\n      ajax(`${location.protocol}//${location.host}/api/contact`, form_data, 'json', 'POST', AJAX_TIMEOUT, true)\r\n        .then((response) => {\r\n          const data = response as ajaxJSONResponse;\r\n          if (data.data === true) {\r\n            if (this.add_thread_form) {\r\n              //Notify TinyMCE, that data was saved\r\n              const textarea = this.add_thread_form.querySelector('textarea');\r\n              if (textarea && !empty(textarea.id)) {\r\n                saveTinyMCE(textarea.id);\r\n              }\r\n            }\r\n            addSnackbar('Thread created. Reloading...', 'success');\r\n            window.location.assign(encodeURI(data.location));\r\n          } else {\r\n            if (data.location) {\r\n              addSnackbar(data.reason + ` View the thread <a href=\"${data.location}\" target=\"_blank\" rel=\"noopener noreferrer\">here</a>.`, 'failure', 0);\r\n            } else {\r\n              addSnackbar(data.reason, 'failure', SNACKBAR_FAIL_LIFE);\r\n            }\r\n          }\r\n          buttonToggle(button as HTMLInputElement);\r\n        });\r\n    }\r\n  }\r\n}\r\n"]}