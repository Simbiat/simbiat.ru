{"version":3,"file":"games.js","sourceRoot":"/js/Pages/","sources":["games/games.ts"],"names":[],"mappings":"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","sourcesContent":["export class Games {\r\n    private readonly wrapper: HTMLDivElement | null = null;\r\n    private readonly jsPath: string | null = null;\r\n    \r\n    public constructor()\r\n    {\r\n        const wrapper = document.querySelector('game-canvas');\r\n        if (wrapper) {\r\n            const button = wrapper.querySelector('button');\r\n            if (button) {\r\n                button.addEventListener('click', () => {\r\n                    this.startGame();\r\n                });\r\n                button.addEventListener('keypress', (event) => {\r\n                    if (['Enter', 'NumpadEnter', 'Space'].includes(event.code)) {\r\n                        this.startGame();\r\n                    }\r\n                });\r\n            }\r\n            const overlay = wrapper.querySelector('#play_overlay');\r\n            if (overlay) {\r\n                overlay.addEventListener('click', () => {\r\n                    this.startGame();\r\n                });\r\n            }\r\n            this.wrapper = wrapper.querySelector('#gm4html5_div_id');\r\n            if (this.wrapper) {\r\n                if (this.wrapper.hasAttribute('data-js')) {\r\n                    this.jsPath = this.wrapper.getAttribute('data-js');\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    private startGame(): void\r\n    {\r\n        if (empty(this.jsPath)) {\r\n            addSnackbar(`No GameMaker JavaScript file provided.`,'failure');\r\n        } else if (this.wrapper) {\r\n            //Check if we already have the canvas running\r\n            if (document.getElementById('canvas')) {\r\n                return;\r\n            }\r\n            //Create canvas\r\n            const canvas = document.createElement('canvas');\r\n            canvas.id = 'canvas';\r\n            //Append canvas\r\n            this.wrapper.appendChild(canvas);\r\n            //Create tag\r\n            const tag = document.createElement('script');\r\n            tag.type = 'text/javascript';\r\n            tag.src = String(this.jsPath);\r\n            tag.onload = (): void => {\r\n                canvas.classList.remove('hidden');\r\n                // @ts-expect-error: GameMaker files are not integrated into main codebase, so suppressing errors\r\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-call\r\n                GameMaker_Init();\r\n                document.querySelector('#play_overlay')?.classList.add('hidden');\r\n                document.querySelector('#gameStartButton')?.classList.add('hidden');\r\n            };\r\n            tag.onerror = (): void => {\r\n                addSnackbar(`Failed to load \\`${String(this.jsPath)}\\` script.`, 'failure');\r\n            };\r\n            //Append the script\r\n            document.head.appendChild(tag);\r\n            //Create observer for the canvas size\r\n            // Create a new MutationObserver\r\n            const observer = new MutationObserver(() => {\r\n                // Get the new dimensions of the element\r\n                const { width, height } = canvas.getBoundingClientRect();\r\n                // If both dimensions are zero, reload\r\n                if (width === 0 && height === 0) {\r\n                    window.location.reload();\r\n                }\r\n            });\r\n            // Start observing the element\r\n            observer.observe(canvas, {\r\n                'attributes': true,\r\n                'childList': true,\r\n                'subtree': true\r\n            });\r\n        } else {\r\n            addSnackbar(`No GameMaker canvas provided.`,'failure');\r\n        }\r\n    }\r\n}\r\n"]}