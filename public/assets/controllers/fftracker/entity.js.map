{"version":3,"file":"entity.js","sourceRoot":"/js/Pages/","sources":["fftracker/entity.ts"],"names":[],"mappings":"AAAA,MAAM,OAAO,QAAQ;IACF,YAAY,GAA4B,IAAI,CAAC;IAE9D;QAEE,IAAI,CAAC,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;QAC1D,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;YAEtB,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACvE,CAAC;IACH,CAAC;IAEO,OAAO,CAAC,KAAY;QAC1B,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;YACtB,IAAI,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC;gBAEjD,KAAK,CAAC,eAAe,EAAE,CAAC;gBACxB,KAAK,CAAC,cAAc,EAAE,CAAC;YACzB,CAAC;iBAAM,CAAC;gBACN,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBACxC,MAAM,CAAC,UAAU,CAAC,GAAG,EAAE;oBACrB,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;wBACvB,OAAO;oBACT,CAAC;oBACD,KAAK,IAAI,CAAC,GAAG,QAAQ,CAAC,QAAQ,KAAK,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,EAAE;wBACnJ,MAAM,IAAI,GAAG,QAA4B,CAAC;wBAC1C,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;4BACtB,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;wBAC7C,CAAC;wBACD,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,EAAE,CAAC;4BACvB,WAAW,CAAC,iCAAiC,EAAE,SAAS,CAAC,CAAC;4BAC1D,WAAW,EAAE,CAAC;wBAChB,CAAC;6BAAM,CAAC;4BACN,WAAW,CAAC,uBAAuB,EAAE,SAAS,EAAE,kBAAkB,CAAC,CAAC;wBACtE,CAAC;oBACH,CAAC,CAAC,CAAC;gBACP,CAAC,EAAE,GAAG,CAAC,CAAC;YACV,CAAC;QACH,CAAC;IACH,CAAC;CACF","sourcesContent":["export class ffEntity {\r\n  private readonly forceRefresh: HTMLInputElement | null = null;\r\n\r\n  public constructor() {\r\n    //Get the refresh button, if it exists\r\n    this.forceRefresh = document.querySelector('#ff_refresh');\r\n    if (this.forceRefresh) {\r\n      //Attach on-click event\r\n      this.forceRefresh.addEventListener('click', this.refresh.bind(this));\r\n    }\r\n  }\r\n\r\n  private refresh(event: Event): void {\r\n    if (this.forceRefresh) {\r\n      if (this.forceRefresh.classList.contains('spin')) {\r\n        //It already has been clicked, cancel event\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n      } else {\r\n        this.forceRefresh.classList.add('spin');\r\n        window.setTimeout(() => {\r\n          if (!this.forceRefresh) {\r\n            return;\r\n          }\r\n          void ajax(`${location.protocol}//${location.host}${this.forceRefresh.getAttribute('data-link') ?? ''}`, null, 'json', 'PUT', 300000).then((response) => {\r\n              const data = response as ajaxJSONResponse;\r\n              if (this.forceRefresh) {\r\n                this.forceRefresh.classList.remove('spin');\r\n              }\r\n              if (data.data === true) {\r\n                addSnackbar('Data updated. Reloading page...', 'success');\r\n                pageRefresh();\r\n              } else {\r\n                addSnackbar('Failed to update data', 'failure', SNACKBAR_FAIL_LIFE);\r\n              }\r\n            });\r\n        }, 500);\r\n      }\r\n    }\r\n  }\r\n}\r\n"]}