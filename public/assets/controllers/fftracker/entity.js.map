{"version":3,"file":"entity.js","sourceRoot":"/js/Pages/","sources":["fftracker/entity.ts"],"names":[],"mappings":"AAAA,MAAM,OAAO,QAAQ;IAEA,YAAY,GAA4B,IAAI,CAAC;IAE9D;QAGI,IAAI,CAAC,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;QAC1D,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;YAEpB,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACzE,CAAC;IACL,CAAC;IAEO,OAAO,CAAC,KAAY;QAExB,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;YACpB,IAAI,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC;gBAE/C,KAAK,CAAC,eAAe,EAAE,CAAC;gBACxB,KAAK,CAAC,cAAc,EAAE,CAAC;YAC3B,CAAC;iBAAM,CAAC;gBACJ,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBACxC,MAAM,CAAC,UAAU,CAAC,GAAG,EAAE;oBACnB,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;wBACrB,OAAO;oBACX,CAAC;oBACD,KAAK,IAAI,CAAC,GAAG,QAAQ,CAAC,QAAQ,KAAK,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,CAAC;wBAChI,IAAI,CAAC,CAAC,QAAQ,EAAE,EAAE;wBACd,MAAM,IAAI,GAAG,QAA4B,CAAC;wBAC1C,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;4BACpB,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;wBAC/C,CAAC;wBACD,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,EAAE,CAAC;4BACrB,WAAW,CAAC,iCAAiC,EAAE,SAAS,CAAC,CAAC;4BAC1D,WAAW,EAAE,CAAC;wBAClB,CAAC;6BAAM,CAAC;4BACJ,WAAW,CAAC,uBAAuB,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;wBAC3D,CAAC;oBACL,CAAC,CAAC,CAAC;gBACX,CAAC,EAAE,GAAG,CAAC,CAAC;YACZ,CAAC;QACL,CAAC;IACL,CAAC;CACJ","sourcesContent":["export class ffEntity\r\n{\r\n    private readonly forceRefresh: HTMLInputElement | null = null;\r\n    \r\n    public constructor()\r\n    {\r\n        //Get the refresh button, if it exists\r\n        this.forceRefresh = document.querySelector('#ff_refresh');\r\n        if (this.forceRefresh) {\r\n            //Attach on-click event\r\n            this.forceRefresh.addEventListener('click', this.refresh.bind(this));\r\n        }\r\n    }\r\n    \r\n    private refresh(event: Event): void\r\n    {\r\n        if (this.forceRefresh) {\r\n            if (this.forceRefresh.classList.contains('spin')) {\r\n                //It already has been clicked, cancel event\r\n                event.stopPropagation();\r\n                event.preventDefault();\r\n            } else {\r\n                this.forceRefresh.classList.add('spin');\r\n                window.setTimeout(() => {\r\n                    if (!this.forceRefresh) {\r\n                        return;\r\n                    }\r\n                    void ajax(`${location.protocol}//${location.host}${this.forceRefresh.getAttribute('data-link') ?? ''}`, null, 'json', 'PUT', 300000).\r\n                        then((response) => {\r\n                            const data = response as ajaxJSONResponse;\r\n                            if (this.forceRefresh) {\r\n                                this.forceRefresh.classList.remove('spin');\r\n                            }\r\n                            if (data.data === true) {\r\n                                addSnackbar('Data updated. Reloading page...', 'success');\r\n                                pageRefresh();\r\n                            } else {\r\n                                addSnackbar('Failed to update data', 'failure', 10000);\r\n                            }\r\n                        });\r\n                }, 500);\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}