{
    //Logs settings
    "logging": {
        "logs": {
            "default": {
                "writer": {
                    "filename": "/app/logs/caddy.log",
                    "output": "file",
                    "roll": true,
                    "roll_size_mb": 10,
                    "roll_keep": 21,
                    "roll_keep_days": 14,
                },
                "level": "WARN",
                "exclude": [
                    "http.log.access"
                ]
            },
            "access_log": {
                "writer": {
                    "filename": "/app/logs/access.log",
                    "output": "file",
                    "roll": true,
                    "roll_size_mb": 50,
                    "roll_keep": 21,
                    "roll_keep_days": 14,
                },
                "level": "DEBUG",
                "include": [
                    "http.log.access"
                ]
            }
        }
    },
    "apps": {
        "crowdsec": {
            "api_key": "{env.CROWDSEC_API_KEY}",
            "api_url": "http://crowdsec:8080/",
            "appsec_url": "http://crowdsec:7422/",
            "ticker_interval": "10s",
            "enable_streaming": true,
            "enable_hard_fails": false,
        },
        //Certificates settings
        "tls": {
            "certificates": {
                "automate": [
                    "simbiat.dev",
                    "www.simbiat.dev",
                    "localhost"
                ]
            },
            "automation": {
                "policies": [
                    {
                        "subjects": [
                            "simbiat.dev",
                            "www.simbiat.dev",
                            "localhost"
                        ],
                        "issuers": [
                            {
                                "module": "acme",
                                "email": "support@simbiat.dev",
                                "acme_timeout": "60s"
                            },
                            {
                                "module": "internal",
                                "lifetime": "30d"
                            }
                        ],
                        "key_type": "rsa4096",
                        "must_staple": false
                    }
                ]
            }
        },
        "frankenphp": {},
        "http": {
            "grace_period": "30s",
            "shutdown_delay": "10s",
            "servers": {
                "server_0": {
                    "listen": [
                        ":80",
                        ":443"
                    ],
                    //Enable access logs for Crowdsec
                    "logs": {
                        "default_logger_name": "access_log"
                    },
                    "read_timeout": "10s",
                    "read_header_timeout": "10s",
                    "write_timeout": "30m",
                    "strict_sni_host": true,
                    "routes": [
                        //Crowdsec
                        {
                            "handle": [
                                {
                                    "handler": "crowdsec"
                                }
                            ]
                        },
                        //Coraza provided by Crowdsec
                        {
                            "handle": [
                                {
                                    "handler": "appsec"
                                }
                            ]
                        },
                        //Force WWW if missing
                        {
                            "match": [
                                {
                                    "host": [
                                        "simbiat.dev"
                                    ]
                                }
                            ],
                            "handle": [
                                {
                                    "handler": "static_response",
                                    "headers": {
                                        "Location": [
                                            "https://www.simbiat.dev{http.request.uri}"
                                        ]
                                    },
                                    "status_code": 308
                                }
                            ]
                        },
                        {
                            "match": [
                                {
                                    "host": [
                                        "www.simbiat.dev",
                                        "localhost"
                                    ]
                                }
                            ],
                            "handle": [
                                //Remove certain headers from responses if they are present
                                {
                                    "handler": "headers",
                                    "response": {
                                        "delete": [
                                            "Expires",
                                            "Host",
                                            "P3P",
                                            "Pragma",
                                            "Public-Key-Pins",
                                            "Public-Key-Pins-Report-Only",
                                            "Server",
                                            "Via",
                                            "X-AspNet-Version",
                                            "X-AspNetMvc-version",
                                            "X-Powered-By",
                                            "X-Runtime",
                                            "X-Version",
                                            "X-UA-Compatible",
                                            "X-Robots-Tag",
                                            "X-Frame-Options",
                                            "X-Requested-With",
                                            "X-Content-Duration",
                                            "X-Pingback"
                                        ]
                                    }
                                },
                                //Some redirects
                                {
                                    "handler": "subroute",
                                    "routes": [
                                        //No trailing slash
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "pattern": "^(.+?)/$",
                                                        "name": "noTrailSlash"
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "static_response",
                                                    "headers": {
                                                        "Location": [
                                                            "{http.regexp.noTrailSlash.1}"
                                                        ]
                                                    },
                                                    "status_code": 308
                                                }
                                            ]
                                        },
                                        //Sitemap with format (legacy)
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "pattern": "/sitemap/(xml|txt|html)(.*)",
                                                        "name": "sitemapFormat"
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "static_response",
                                                    "headers": {
                                                        "Location": [
                                                            "/sitemap{http.regexp.sitemapFormat.2}"
                                                        ]
                                                    },
                                                    "status_code": 308
                                                }
                                            ]
                                        },
                                        //Sitemap without a file specified
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "pattern": "/sitemap/?$",
                                                        "name": "sitemapNoFile"
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "static_response",
                                                    "headers": {
                                                        "Location": [
                                                            "/sitemap/index.xml"
                                                        ]
                                                    },
                                                    "status_code": 308
                                                }
                                            ]
                                        },
                                        //Sitemap without .xml
                                        {
                                            "match": [
                                                {
                                                    //Negative look behind does not seem to work here
                                                    //Thrown "invalid named capture" error, so using "not", too
                                                    "path_regexp": {
                                                        "pattern": "/sitemap/(.+)$",
                                                        "name": "sitemapNoExtension"
                                                    },
                                                    "not": [
                                                        {
                                                            "path": [
                                                                "*.xml"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "static_response",
                                                    "headers": {
                                                        "Location": [
                                                            "/sitemap/{http.regexp.sitemapNoExtension.1}.xml"
                                                        ]
                                                    },
                                                    "status_code": 308
                                                }
                                            ]
                                        }
                                    ]
                                },
                                //Rewrite rules
                                {
                                    "handler": "subroute",
                                    "routes": [
                                        //Favicon
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "/favicon.ico"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "/assets/images/favicons/favicon.ico"
                                                }
                                            ]
                                        },
                                        //Main CSS file
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "pattern": "((^|/)assets/styles/\\d+\\.css)"
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "/assets/styles/app.css"
                                                }
                                            ]
                                        },
                                        //Main CSS map file
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "pattern": "((^|/)assets/styles/\\d+\\.css.map)"
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "/assets/styles/app.css.map"
                                                }
                                            ]
                                        },
                                        //JS files and their maps
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "pattern": "(^|/)assets/(.+)\\.\\d+(\\.json|\\.js|\\.js\\.map)",
                                                        "name": "jsFiles"
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "/assets/{http.regexp.jsFiles.2}{http.regexp.jsFiles.3}"
                                                }
                                            ]
                                        },
                                        //GameMaker files
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "pattern": "(^|/)games/(.*/)?html5games/(.*)$",
                                                        "name": "gameMaker"
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "/assets/html5games/{http.regexp.gameMaker.3}"
                                                }
                                            ]
                                        },
                                        //TinyMCE
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "tinymce",
                                                        "pattern": "/tinymce/(.*)"
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app/vendor/tinymce"
                                                }
                                            ]
                                        },
                                        //Old "static" assets
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "oldStatic",
                                                        "pattern": "/static/(.*)"
                                                    },
                                                    "file": {
                                                        "root": "/app",
                                                        "split_path": [],
                                                        "try_policy": "first_exist",
                                                        "try_files": [
                                                            "/public/static/{http.regexp.oldStatic.1}",
                                                            "/public/{http.regexp.oldStatic.1}"
                                                        ]
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                },
                                                {
                                                    "handler": "file_server"
                                                }
                                            ]
                                        },
                                        //Merged crests
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "mergedCrest",
                                                        "pattern": "/assets/images/fftracker/merged-crests/(.*\\.(svg|png|jpeg|jpg|avif|heic|gif|webp))"
                                                    },
                                                    "file": {
                                                        "root": "/app",
                                                        "split_path": [],
                                                        "try_policy": "first_exist_fallback",
                                                        "try_files": [
                                                            "/data/mergedcrests/{http.request.uri.path.4}/{http.request.uri.path.5}/{http.request.uri.path.6}",
                                                            "/public/assets/images/fftracker/default-crests/pvp.webp",
                                                            "/public/assets/images/noimage.svg"
                                                        ]
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                },
                                                //Return 404 if we failback to noimage.svg
                                                {
                                                    "handler": "subroute",
                                                    "routes": [
                                                        {
                                                            "match": [
                                                                {
                                                                    "path": [
                                                                        "/public/assets/images/noimage.svg"
                                                                    ]
                                                                }
                                                            ],
                                                            "handle": [
                                                                {
                                                                    "handler": "file_server",
                                                                    "root": "/app",
                                                                    "status_code": 404
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app"
                                                }
                                            ]
                                        },
                                        //FFXIV Job icons
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "ffxivJobs",
                                                        "pattern": "/assets/images/fftracker/jobs/(.*\\.(svg|png|jpeg|jpg|avif|heic|gif|webp))"
                                                    },
                                                    "file": {
                                                        "root": "/app/public",
                                                        "split_path": [],
                                                        "try_policy": "first_exist_fallback",
                                                        "try_files": [
                                                            "/assets/images/fftracker/jobs/{http.request.uri.path.4}",
                                                            "/assets/images/fftracker/jobs/None.webp",
                                                            "/assets/images/noimage.svg"
                                                        ]
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                },
                                                //Return 404 if we failback to noimage.svg
                                                {
                                                    "handler": "subroute",
                                                    "routes": [
                                                        {
                                                            "match": [
                                                                {
                                                                    "path": [
                                                                        "/assets/images/fftracker/jobs/None.webp",
                                                                        "/assets/images/noimage.svg"
                                                                    ]
                                                                }
                                                            ],
                                                            "handle": [
                                                                {
                                                                    "handler": "file_server",
                                                                    "root": "/app/public",
                                                                    "status_code": 404
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app/public"
                                                }
                                            ]
                                        },
                                        //FFXIV icons
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "ffxivIcons",
                                                        "pattern": "/assets/images/fftracker/icons/(.*\\.(svg|png|jpeg|jpg|avif|heic|gif|webp))"
                                                    },
                                                    "file": {
                                                        "root": "/app",
                                                        "split_path": [],
                                                        "try_policy": "first_exist_fallback",
                                                        "try_files": [
                                                            "/lib/FFXIV/Icons/{http.request.uri.path.4}/{http.request.uri.path.5}",
                                                            "/public/assets/images/noimage.svg"
                                                        ]
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                },
                                                //Return 404 if we failback to noimage.svg
                                                {
                                                    "handler": "subroute",
                                                    "routes": [
                                                        {
                                                            "match": [
                                                                {
                                                                    "path": [
                                                                        "/public/assets/images/noimage.svg"
                                                                    ]
                                                                }
                                                            ],
                                                            "handle": [
                                                                {
                                                                    "handler": "file_server",
                                                                    "root": "/app",
                                                                    "status_code": 404
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app"
                                                }
                                            ]
                                        },
                                        //FFXIV crests components
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "ffxivCrestsComponents",
                                                        "pattern": "/assets/images/fftracker/crests-components/(.*\\.(svg|png|jpeg|jpg|avif|heic|gif|webp))"
                                                    },
                                                    "file": {
                                                        "root": "/app",
                                                        "split_path": [],
                                                        "try_policy": "first_exist_fallback",
                                                        "try_files": [
                                                            "/lib/FFXIV/CrestComponents/{http.request.uri.path.4}/{http.request.uri.path.5}/{http.request.uri.path.6}",
                                                            "/lib/FFXIV/CrestComponents/{http.request.uri.path.4}/{http.request.uri.path.5}",
                                                            "/public/assets/images/noimage.svg"
                                                        ]
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                },
                                                //Return 404 if we failback to noimage.svg
                                                {
                                                    "handler": "subroute",
                                                    "routes": [
                                                        {
                                                            "match": [
                                                                {
                                                                    "path": [
                                                                        "/public/assets/images/noimage.svg"
                                                                    ]
                                                                }
                                                            ],
                                                            "handle": [
                                                                {
                                                                    "handler": "file_server",
                                                                    "root": "/app",
                                                                    "status_code": 404
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app"
                                                }
                                            ]
                                        },
                                        //FFXIV estate maps
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "ffxivEstateMaps",
                                                        "pattern": "/assets/images/fftracker/maps/(.*\\.(svg|png|jpeg|jpg|avif|heic|gif|webp))"
                                                    },
                                                    "file": {
                                                        "root": "/app",
                                                        "split_path": [],
                                                        "try_policy": "first_exist_fallback",
                                                        "try_files": [
                                                            "/lib/FFXIV/EstateMaps/{http.request.uri.path.4}/{http.request.uri.path.5}",
                                                            "/public/assets/images/noimage.svg"
                                                        ]
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                },
                                                //Return 404 if we failback to noimage.svg
                                                {
                                                    "handler": "subroute",
                                                    "routes": [
                                                        {
                                                            "match": [
                                                                {
                                                                    "path": [
                                                                        "/public/assets/images/noimage.svg"
                                                                    ]
                                                                }
                                                            ],
                                                            "handle": [
                                                                {
                                                                    "handler": "file_server",
                                                                    "root": "/app",
                                                                    "status_code": 404
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app"
                                                }
                                            ]
                                        },
                                        //Avatars
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "avatars",
                                                        "pattern": "/assets/images/avatars/(.*\\.(svg|png|jpeg|jpg|avif|heic|gif|webp))"
                                                    },
                                                    "file": {
                                                        "root": "/app",
                                                        "split_path": [],
                                                        "try_policy": "first_exist_fallback",
                                                        "try_files": [
                                                            "/data/uploadedimages/{http.request.uri.path.3}/{http.request.uri.path.4}/{http.request.uri.path.5}/{http.request.uri.path.6}",
                                                            "/public/assets/images/avatar.svg"
                                                        ]
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                },
                                                //Return 404 if we failback to noimage.svg
                                                {
                                                    "handler": "subroute",
                                                    "routes": [
                                                        {
                                                            "match": [
                                                                {
                                                                    "path": [
                                                                        "/public/assets/images/avatar.svg"
                                                                    ]
                                                                }
                                                            ],
                                                            "handle": [
                                                                {
                                                                    "handler": "file_server",
                                                                    "root": "/app",
                                                                    "status_code": 404
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app"
                                                }
                                            ]
                                        },
                                        //Uploaded images
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "uploadedImages",
                                                        "pattern": "/assets/images/uploaded/(.*\\.(svg|png|jpeg|jpg|avif|heic|gif|webp))"
                                                    },
                                                    "file": {
                                                        "root": "/app",
                                                        "split_path": [],
                                                        "try_policy": "first_exist_fallback",
                                                        "try_files": [
                                                            "/data/uploadedimages/{http.request.uri.path.3}/{http.request.uri.path.4}/{http.request.uri.path.5}/{http.request.uri.path.6}",
                                                            "/public/assets/images/noimage.svg"
                                                        ]
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                },
                                                //Return 404 if we failback to noimage.svg
                                                {
                                                    "handler": "subroute",
                                                    "routes": [
                                                        {
                                                            "match": [
                                                                {
                                                                    "path": [
                                                                        "/public/assets/images/noimage.svg"
                                                                    ]
                                                                }
                                                            ],
                                                            "handle": [
                                                                {
                                                                    "handler": "file_server",
                                                                    "root": "/app",
                                                                    "status_code": 404
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app"
                                                }
                                            ]
                                        },
                                        //Old image folder
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "oldImages",
                                                        "pattern": "/img/uploaded/(.*\\.(svg|png|jpeg|jpg|avif|heic|gif|webp))"
                                                    },
                                                    "file": {
                                                        "root": "/app/public",
                                                        "split_path": [],
                                                        "try_policy": "first_exist_fallback",
                                                        "try_files": [
                                                            "/assets/images/noimage.svg"
                                                        ]
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                },
                                                //Return 404 if we failback to noimage.svg
                                                {
                                                    "handler": "subroute",
                                                    "routes": [
                                                        {
                                                            "match": [
                                                                {
                                                                    "path": [
                                                                        "/assets/images/noimage.svg"
                                                                    ]
                                                                }
                                                            ],
                                                            "handle": [
                                                                {
                                                                    "handler": "file_server",
                                                                    "root": "/app/public",
                                                                    "status_code": 404
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app/public"
                                                }
                                            ]
                                        },
                                        //Device detector icons
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "DDCIcons",
                                                        "pattern": "/assets/images/devicedetector/(.*\\.(svg|png|jpeg|jpg|avif|heic|gif|webp))"
                                                    },
                                                    "file": {
                                                        "root": "/app",
                                                        "split_path": [],
                                                        "try_policy": "first_exist_fallback",
                                                        "try_files": [
                                                            "/lib/DDCIcons/src/icons/{http.request.uri.path.3}/{http.request.uri.path.4}/{http.request.uri.path.5}/{http.request.uri.path.6}",
                                                            "/lib/DDCIcons/src/icons/{http.request.uri.path.3}/{http.request.uri.path.4}/{http.request.uri.path.5}",
                                                            "/lib/DDCIcons/src/icons/{http.request.uri.path.3}/{http.request.uri.path.4}",
                                                            "/lib/DDCIcons/src/icons/{http.request.uri.path.3}",
                                                            "/public/assets/images/noimage.svg"
                                                        ]
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                },
                                                //Return 404 if we failback to noimage.svg
                                                {
                                                    "handler": "subroute",
                                                    "routes": [
                                                        {
                                                            "match": [
                                                                {
                                                                    "path": [
                                                                        "/public/assets/images/noimage.svg"
                                                                    ]
                                                                }
                                                            ],
                                                            "handle": [
                                                                {
                                                                    "handler": "file_server",
                                                                    "root": "/app",
                                                                    "status_code": 404
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app"
                                                }
                                            ]
                                        },
                                        //All other images
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "missingImages",
                                                        "pattern": "/assets/images/(.*\\.(svg|png|jpeg|jpg|avif|heic|gif|webp))"
                                                    },
                                                    "file": {
                                                        "root": "/app/public",
                                                        "split_path": [],
                                                        "try_policy": "first_exist_fallback",
                                                        "try_files": [
                                                            "{http.request.uri.path}",
                                                            "/assets/images/noimage.svg"
                                                        ]
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                },
                                                //Return 404 if we failback to noimage.svg
                                                {
                                                    "handler": "subroute",
                                                    "routes": [
                                                        {
                                                            "match": [
                                                                {
                                                                    "path": [
                                                                        "/assets/images/noimage.svg"
                                                                    ]
                                                                }
                                                            ],
                                                            "handle": [
                                                                {
                                                                    "handler": "file_server",
                                                                    "root": "/app/public",
                                                                    "status_code": 404
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app/public"
                                                }
                                            ]
                                        },
                                        //Sitemap (This is an attempt to force Google Search to recognize the sitemaps)
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "/sitemap.xml"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "/sitemap/index.xml"
                                                }
                                            ]
                                        },
                                        //Feed sitemaps from actual data directory
                                        {
                                            "match": [
                                                {
                                                    "path_regexp": {
                                                        "name": "sitemapRewrite",
                                                        "pattern": "/sitemap/(.+)"
                                                    }
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "file_server",
                                                    "root": "/app/data"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                //Set Cache-Control, if empty
                                {
                                    "handler": "headers",
                                    "response": {
                                        "set": {
                                            "Cache-Control": [
                                                "max-age=31536000,public,immutable, stale-while-revalidate=1800,stale-if-error=1800,no-transform"
                                            ]
                                        },
                                        "require": {
                                            "headers": {
                                                "Cache-Control": null
                                            }
                                        }
                                    }
                                },
                                //Set Cache-Control for HTML5 games
                                {
                                    "handler": "subroute",
                                    "routes": [
                                        {
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Cache-Control": [
                                                                "max-age=1800,public,stale-while-revalidate=1800,stale-if-error=1800,no-transform"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "path": [
                                                        "/assets/html5games*",
                                                        "/html5games*",
                                                        "/games/html5games*"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                //Set Cache-Control based on MIME, if empty
                                {
                                    "handler": "subroute",
                                    "routes": [
                                        {
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Cache-Control": [
                                                                "max-age=31556952,public,immutable, stale-while-revalidate=1800,stale-if-error=1800,no-transform"
                                                            ]
                                                        },
                                                        "deferred": true
                                                    }
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "header": {
                                                        "Cache-Control": null,
                                                        "Content-Type": [
                                                            "text/css*",
                                                            "application/javascript*",
                                                            "application/x-javascript*",
                                                            "text/javascript*"
                                                        ]
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Cache-Control": [
                                                                "max-age=3600,public, stale-while-revalidate=1800,stale-if-error=1800,no-transform"
                                                            ]
                                                        },
                                                        "deferred": true
                                                    }
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "header": {
                                                        "Cache-Control": null,
                                                        "Content-Type": [
                                                            "application/atom+xml*",
                                                            "application/rdf+xml*",
                                                            "application/rss+xml*"
                                                        ]
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Cache-Control": [
                                                                "public,no-cache, stale-while-revalidate=1800,stale-if-error=1800,no-transform"
                                                            ]
                                                        },
                                                        "deferred": true
                                                    }
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "header": {
                                                        "Cache-Control": null,
                                                        "Content-Type": [
                                                            "application/json*",
                                                            "application/ld+json*",
                                                            "application/schema+json*",
                                                            "application/geo+json*",
                                                            "application/xml*",
                                                            "text/calendar*",
                                                            "text/xml*",
                                                            "application/x-web-app-manifest+json*",
                                                            "text/cache-manifest*",
                                                            "text/markdown*"
                                                        ]
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Cache-Control": [
                                                                "max-age=60,public, stale-while-revalidate=1800,stale-if-error=1800,no-transform"
                                                            ]
                                                        },
                                                        "deferred": true
                                                    }
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "header": {
                                                        "Cache-Control": null,
                                                        "Content-Type": [
                                                            "text/html*"
                                                        ]
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Cache-Control": [
                                                                "max-age=604800,public, stale-while-revalidate=1800,stale-if-error=1800,no-transform"
                                                            ]
                                                        },
                                                        "deferred": true
                                                    }
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "header": {
                                                        "Cache-Control": null,
                                                        "Content-Type": [
                                                            "application/manifest+json*",
                                                            "text/x-cross-domain-policy*"
                                                        ]
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Cache-Control": [
                                                                "max-age=31556952,public, stale-while-revalidate=1800,stale-if-error=1800,no-transform"
                                                            ]
                                                        },
                                                        "deferred": true
                                                    }
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "header": {
                                                        "Cache-Control": null,
                                                        "Content-Type": [
                                                            "application/wasm*"
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    ]
                                },
                                //Set Access-Control-Expose-Headers, if empty
                                {
                                    "handler": "headers",
                                    "response": {
                                        "set": {
                                            "Access-Control-Expose-Headers": [
                                                "SourceMap, Cache-Control, Content-Language, Content-Type, Last-Modified, Strict-Transport-Security, Access-Control-Max-Age, Access-Control-Allow-Credentials, Vary, Access-Control-Allow-Origin, Access-Control-Expose-Headers, Access-Control-Allow-Headers, Access-Control-Allow-Methods, Cross-Origin-Embedder-Policy, Cross-Origin-Opener-Policy, Cross-Origin-Resource-Policy, Referrer-Policy, Content-Security-Policy, Content-Security-Policy-Report-Only, X-Content-Type-Options, X-DNS-Prefetch-Control, Connection, Keep-Alive, Feature-Policy, ETag, Link"
                                            ]
                                        },
                                        "require": {
                                            "headers": {
                                                "Access-Control-Expose-Headers": null
                                            }
                                        }
                                    }
                                },
                                //Set Access-Control-Allow-Methods, if empty
                                {
                                    "handler": "headers",
                                    "response": {
                                        "set": {
                                            "Access-Control-Allow-Methods": [
                                                "HEAD, OPTIONS, GET"
                                            ]
                                        },
                                        "require": {
                                            "headers": {
                                                "Access-Control-Allow-Methods": null
                                            }
                                        }
                                    }
                                },
                                //Set Allow, if empty
                                {
                                    "handler": "headers",
                                    "response": {
                                        "set": {
                                            "Allow": [
                                                "HEAD, OPTIONS, GET"
                                            ]
                                        },
                                        "require": {
                                            "headers": {
                                                "Allow": null
                                            }
                                        }
                                    }
                                },
                                //Set some headers based on a path
                                {
                                    "handler": "subroute",
                                    "routes": [
                                        //Allow access to images from outside (for example, just opening them in a separate tab)
                                        {
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Access-Control-Allow-Origin": [
                                                                "*"
                                                            ]
                                                        },
                                                        "deferred": true
                                                    }
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "path": [
                                                        "/img*",
                                                        "/data/uploadedimages*",
                                                        "/data/mergedcrests*"
                                                    ]
                                                }
                                            ]
                                        },
                                        //FFTracker loads some images directly from FFXIV Lodestone, and they lack cross-origin headers on them (I did ask SE to amend that, but still no change)
                                        //Thankfully, COEP is not as critical, and respective functions are not expected to be used on these pages, so we can disable it on them,
                                        {
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Cross-Origin-Embedder-Policy": [
                                                                "unsafe-none"
                                                            ]
                                                        },
                                                        "deferred": true
                                                    }
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "path": [
                                                        "/uc/fftracker*",
                                                        "/fftracker*",
                                                        "/talks/users*"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                //Allow cross-origin for certain MIME types
                                {
                                    "handler": "headers",
                                    "response": {
                                        "set": {
                                            "Cross-Origin-Resource-Policy": [
                                                "cross-origin"
                                            ]
                                        },
                                        "require": {
                                            "headers": {
                                                "Content-Type": [
                                                    "image/*",
                                                    "audio/*",
                                                    "video/*",
                                                    "font/*",
                                                    "application/json*",
                                                    "application/xml*"
                                                ]
                                            }
                                        }
                                    }
                                },
                                //Force some standard headers
                                {
                                    "handler": "headers",
                                    "response": {
                                        "set": {
                                            "Timing-Allow-Origin": [
                                                "{http.request.scheme}://{http.request.host}:{http.request.local.port}"
                                            ],
                                            "Strict-Transport-Security": [
                                                "max-age=31536000; includeSubDomains; preload"
                                            ],
                                            "Access-Control-Max-Age": [
                                                "86400"
                                            ],
                                            "Access-Control-Allow-Credentials": [
                                                "true"
                                            ],
                                            "X-Content-Type-Options": [
                                                "nosniff"
                                            ],
                                            "Referrer-Policy": [
                                                "no-referrer"
                                            ],
                                            "Cross-Origin-Opener-Policy": [
                                                "same-origin"
                                            ],
                                            "Access-Control-Allow-Origin": [
                                                "{http.request.scheme}://{http.request.host}:{http.request.local.port}"
                                            ],
                                            "Cross-Origin-Embedder-Policy": [
                                                "require-corp"
                                            ],
                                            "Cross-Origin-Resource-Policy": [
                                                "same-origin"
                                            ]
                                        }
                                    }
                                },
                                //Add Accept-Encoding to Vary if Content-Encoding is set
                                {
                                    "handler": "headers",
                                    "response": {
                                        "require": {
                                            "headers": {
                                                "Content-Encoding": []
                                            }
                                        },
                                        "set": {
                                            "Vary": [
                                                "Origin, Save-Data, Accept-Encoding"
                                            ]
                                        }
                                    }
                                },
                                //Add Vary to all responses
                                {
                                    "handler": "headers",
                                    "response": {
                                        "set": {
                                            "Vary": [
                                                "Origin, Save-Data"
                                            ]
                                        },
                                        //Required to avoid duplicate headers
                                        "deferred": true
                                    }
                                },
                                //Force UTF-8 charset to certain MIME types
                                {
                                    "handler": "headers",
                                    "response": {
                                        "require": {
                                            "headers": {
                                                "Content-Type": [
                                                    "text/*",
                                                    "application/xml",
                                                    "application/atom+xml",
                                                    "application/x-bb-appworld",
                                                    "application/xml-dtd",
                                                    "application/json",
                                                    "application/rdf+xml",
                                                    "application/rss+xml",
                                                    "image/svg+xml",
                                                    "application/manifest+json"
                                                ]
                                            }
                                        },
                                        "replace": {
                                            "Content-Type": [
                                                {
                                                    "search_regexp": "^([^;]+)(;?\\s*)$",
                                                    "replace": "$1; charset=UTF-8"
                                                }
                                            ]
                                        }
                                    }
                                },
                                //Force MIME types for files of specific extensions
                                {
                                    "handler": "subroute",
                                    "routes": [
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.aw"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/applixware"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.z"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/compress"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.woff4"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/font-woff2"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.gpx"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/gpx+xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.gzip"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/gzip"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.ear"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/java-archive"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.war"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/java-archive"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.map"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/json"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.topojson"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/json"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.mathml"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/mathml+xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.mscml"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/mediaservercontrol+xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.img"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/octet-stream"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.lza"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/octet-stream"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.safariextz"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/octet-stream"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.onetoc"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/onenote"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.rsd"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/rsd+xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.sbml"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/sbml+xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.setpay"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/set-payment-initiation"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.setreg"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/set-registration-initiation"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.tar.gz"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/tar+gz"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.air"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/vnd.adobe.air-application-installer-package+zip"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.azw"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/vnd.amazon.ebook"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.pcurl"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/vnd.curl.pcurl"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.wri"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/vnd.ms-write"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.n-gage"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/vnd.nokia.n-gage.symbian.install"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.odft"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/vnd.oasis.opendocument.formula-template"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.musicxml"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/vnd.recordare.musicxml+xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.svd"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/vnd.svd"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.vsdx"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/vnd.visio2013"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.wtls-ca-certificate"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/vnd.wap.wtls-ca-certificate"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.osfpvg"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/vnd.yamaha.openscoreformat.osfpvg+xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.hlp"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/winhlp"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.ace"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-ace-compressed"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.aab"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-authorware-bin"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.aam"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-authorware-map"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.aas"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-authorware-seg"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.bbaw"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-bb-appworld"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.bz"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-bzip"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.bz2"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-bzip"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.chat"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-chat"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.crx"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-chrome-extension"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.cco"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-cocoa"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.ncx"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-dtbncx+xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.dtb"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-dtbook+xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.res"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-dtbresource+xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.xenc"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/xenc+xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.bdf"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-font-bdf"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.psf"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-font-linux-psf"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.snf"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-font-snf"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.woff_o1"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-font-woff"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.jardiff"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-java-archive-diff"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.run"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-makeself"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.xsd"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.xsl"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/xml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.application"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-ms-application"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.obd"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-msbinder"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.crd"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-mscardfile"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.clp"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-msclip"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.trm"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-msterminal"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.xbap"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-ms-xbap"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.oex"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-opera-extension"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.p7b"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-pkcs7-certificates"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.sea"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-sea"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.xap"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-silverlight-app"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.tfm"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-tex-tfm"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.webapp"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-web-app-manifest+json"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.der"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "application/x-x509-ca-cert"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.adp"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "audio/adpcm"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.kar"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "audio/midi"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.midi"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "audio/midi"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.f4a"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "audio/mp1"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.f4b"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "audio/mp2"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.mp4a"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "audio/mp4"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.dra"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "audio/vnd.dra"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.weba"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "audio/webm"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.rmp"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "audio/x-pn-realaudio-plugin"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.ttf2"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "font/ttf"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.woff3"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "font/woff"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.avifs"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "image/avif-sequence"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.g3"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "image/g3fax"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.pjpeg"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "image/pjpeg"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.sub"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "image/vnd.dvb.subtitle"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.npx"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "image/vnd.net-fpx"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.cmx"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "image/x-cmx"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.fh"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "image/x-freehand"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.cur"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "image/x-icon"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.pic"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "image/x-pict"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.js2"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/javascript"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.js3"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/javascript"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.cjs"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/javascript"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.jsp"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/plain"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.log"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/plain"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.par"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/plain-bas"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.rtx"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/richtext"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.dcurl"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/vnd.curl.dcurl"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.mcurl"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/vnd.curl.mcurl"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.scurl"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/vnd.curl.scurl"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.xloc"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/vnd.rim.location.xloc"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.s"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/x-asm"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.c"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/x-c"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.f"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/x-fortran"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.uu"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/x-uuencode"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.yaml"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/yaml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.yml"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "text/yaml"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.3gp"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "video/3gpp"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.3gpp"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "video/3gpp"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.3g2"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "video/3gpp2"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.asx"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "video/asf"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.h261"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "video/h261"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.h263"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "video/h263"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.h264"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "video/h264"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.jpgv"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "video/jpeg"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.f4v"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "video/mp1"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.f4p"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "video/mp2"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.qtvr"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "video/quicktime"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.ice"
                                                    ]
                                                }
                                            ],
                                            "handle": [
                                                {
                                                    "handler": "headers",
                                                    "response": {
                                                        "set": {
                                                            "Content-Type": [
                                                                "x-conference/x-cooltalk"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    ]
                                },
                                //Deny access to some things
                                {
                                    "handler": "subroute",
                                    "routes": [
                                        //Deny TRACE method for all requests and POST method for requests using HTTP below 1.1
                                        {
                                            "handle": [
                                                {
                                                    "handler": "error",
                                                    "status_code": 405
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "protocol": "http/0.9",
                                                    "method": [
                                                        "POST"
                                                    ]
                                                },
                                                {
                                                    "protocol": "http/1.0",
                                                    "method": [
                                                        "POST"
                                                    ]
                                                },
                                                {
                                                    "method": [
                                                        "TRACE"
                                                    ]
                                                }
                                            ]
                                        },
                                        //Deny access to certain folders. They should not be in /public, but just as a precaution
                                        //Some of these folders are legacy, but keeping them also as a precaution
                                        {
                                            "handle": [
                                                {
                                                    "handler": "error",
                                                    "status_code": 403
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "path": [
                                                        "/bin*",
                                                        "/build*",
                                                        "/config*",
                                                        "/lib*",
                                                        "/logs*",
                                                        "/node_modules*",
                                                        "/templates*",
                                                        "/twig*",
                                                        "/vendor*",
                                                        "/.*",
                                                        "/data*"
                                                    ],
                                                    "not": [
                                                        {
                                                            "path": [
                                                                //Access to the TinyMCE folder is required for loading of the editor components
                                                                "/vendor/tinymce/*",
                                                                //well-known folder is allowed to be accessed
                                                                "/.well-known/*",
                                                                //It is ok to access certain data folders
                                                                "/data/sitemap*",
                                                                "/data/mergedcrests*",
                                                                "/data/ffstatistics*",
                                                                "/data/uploaded*",
                                                                "/data/uploadedimages*"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                //Compression settings
                                {
                                    "handler": "subroute",
                                    "routes": [
                                        {
                                            "handle": [
                                                {
                                                    "handler": "vars",
                                                    "root": "/app/public/"
                                                },
                                                {
                                                    "handler": "encode",
                                                    "encodings": {
                                                        "br": {
                                                            "quality": 6,
                                                            "lgwin": 0
                                                        },
                                                        "gzip": {
                                                            "level": 6
                                                        },
                                                        "zstd": {}
                                                    },
                                                    "prefer": [
                                                        "zstd",
                                                        "br",
                                                        "gzip"
                                                    ],
                                                    "minimum_length": 256,
                                                    "match": {
                                                        "headers": {
                                                            "Content-Type": [
                                                                "application/atom+xml*",
                                                                "application/eot*",
                                                                "application/font*",
                                                                "application/geo+json*",
                                                                "application/graphql+json*",
                                                                "application/javascript*",
                                                                "application/json*",
                                                                "application/ld+json*",
                                                                "application/manifest+json*",
                                                                "application/opentype*",
                                                                "application/otf*",
                                                                "application/rdf+xml",
                                                                "application/rss+xml*",
                                                                "application/schema+json",
                                                                "application/sql",
                                                                "application/truetype*",
                                                                "application/ttf*",
                                                                "application/vnd.api+json*",
                                                                "application/vnd.ms-fontobject*",
                                                                "application/wasm*",
                                                                "application/x-font-ttf",
                                                                "application/xhtml+xml*",
                                                                "application/x-httpd-cgi*",
                                                                "application/x-javascript*",
                                                                "application/xml*",
                                                                "application/x-opentype*",
                                                                "application/x-otf*",
                                                                "application/x-perl*",
                                                                "application/x-protobuf*",
                                                                "application/x-ttf*",
                                                                "application/x-web-app-manifest+json",
                                                                "font/*",
                                                                "image/bmp",
                                                                "image/svg+xml*",
                                                                "image/vnd.microsoft.icon*",
                                                                "image/x-icon*",
                                                                "multipart/bag*",
                                                                "multipart/mixed*",
                                                                "text/*"
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    ]
                                },
                                //Caddy's `php_server` directive)
                                {
                                    "handler": "subroute",
                                    "routes": [
                                        {
                                            "handle": [
                                                {
                                                    "handler": "static_response",
                                                    "headers": {
                                                        "Location": [
                                                            "{http.request.orig_uri.path}/"
                                                        ]
                                                    },
                                                    "status_code": 308
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "file": {
                                                        "try_files": [
                                                            "{http.request.uri.path}/index.php"
                                                        ]
                                                    },
                                                    "not": [
                                                        {
                                                            "path": [
                                                                "*/"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "handle": [
                                                {
                                                    "handler": "rewrite",
                                                    "uri": "{http.matchers.file.relative}"
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "file": {
                                                        "split_path": [
                                                            ".php"
                                                        ],
                                                        "try_files": [
                                                            "{http.request.uri.path}",
                                                            "{http.request.uri.path}/index.php",
                                                            "index.php"
                                                        ]
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "handle": [
                                                {
                                                    "handler": "php",
                                                    "split_path": [
                                                        ".php"
                                                    ]
                                                }
                                            ],
                                            "match": [
                                                {
                                                    "path": [
                                                        "*.php"
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "handle": [
                                                {
                                                    "handler": "file_server"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "terminal": true
                        }
                    ],
                    //Use PHP to generate error pages
                    "errors": {
                        "routes": [
                            {
                                "match": [
                                    {
                                        "host": [
                                            "www.simbiat.dev",
                                            "localhost"
                                        ]
                                    }
                                ],
                                "handle": [
                                    {
                                        "handler": "subroute",
                                        "routes": [
                                            //This routes replicates selected header processing from the main route,
                                            //since otherwise processing does not reach them (due to error)
                                            {
                                                "handle": [
                                                    //Remove certain headers from responses if they are present
                                                    {
                                                        "handler": "headers",
                                                        "response": {
                                                            "delete": [
                                                                "Expires",
                                                                "Host",
                                                                "P3P",
                                                                "Pragma",
                                                                "Public-Key-Pins",
                                                                "Public-Key-Pins-Report-Only",
                                                                "Server",
                                                                "Via",
                                                                "X-AspNet-Version",
                                                                "X-AspNetMvc-version",
                                                                "X-Powered-By",
                                                                "X-Runtime",
                                                                "X-Version",
                                                                "X-UA-Compatible",
                                                                "X-Robots-Tag",
                                                                "X-Frame-Options",
                                                                "X-Requested-With",
                                                                "X-Content-Duration",
                                                                "X-Pingback"
                                                            ]
                                                        }
                                                    },
                                                    //Set Access-Control-Expose-Headers, if empty
                                                    {
                                                        "handler": "headers",
                                                        "response": {
                                                            "set": {
                                                                "Access-Control-Expose-Headers": [
                                                                    "SourceMap, Cache-Control, Content-Language, Content-Type, Last-Modified, Strict-Transport-Security, Access-Control-Max-Age, Access-Control-Allow-Credentials, Vary, Access-Control-Allow-Origin, Access-Control-Expose-Headers, Access-Control-Allow-Headers, Access-Control-Allow-Methods, Cross-Origin-Embedder-Policy, Cross-Origin-Opener-Policy, Cross-Origin-Resource-Policy, Referrer-Policy, Content-Security-Policy, Content-Security-Policy-Report-Only, X-Content-Type-Options, X-DNS-Prefetch-Control, Connection, Keep-Alive, Feature-Policy, ETag, Link"
                                                                ]
                                                            },
                                                            "require": {
                                                                "headers": {
                                                                    "Access-Control-Expose-Headers": null
                                                                }
                                                            }
                                                        }
                                                    },
                                                    //Set Access-Control-Allow-Methods, if empty
                                                    {
                                                        "handler": "headers",
                                                        "response": {
                                                            "set": {
                                                                "Access-Control-Allow-Methods": [
                                                                    "HEAD, OPTIONS, GET"
                                                                ]
                                                            },
                                                            "require": {
                                                                "headers": {
                                                                    "Access-Control-Allow-Methods": null
                                                                }
                                                            }
                                                        }
                                                    },
                                                    //Force some standard headers
                                                    {
                                                        "handler": "headers",
                                                        "response": {
                                                            "set": {
                                                                "Timing-Allow-Origin": [
                                                                    "{http.request.scheme}://{http.request.host}:{http.request.local.port}"
                                                                ],
                                                                "Strict-Transport-Security": [
                                                                    "max-age=31536000; includeSubDomains; preload"
                                                                ],
                                                                "Access-Control-Max-Age": [
                                                                    "86400"
                                                                ],
                                                                "Access-Control-Allow-Credentials": [
                                                                    "true"
                                                                ],
                                                                "X-Content-Type-Options": [
                                                                    "nosniff"
                                                                ],
                                                                "Referrer-Policy": [
                                                                    "no-referrer"
                                                                ],
                                                                "Cross-Origin-Opener-Policy": [
                                                                    "same-origin"
                                                                ],
                                                                "Access-Control-Allow-Origin": [
                                                                    "{http.request.scheme}://{http.request.host}:{http.request.local.port}"
                                                                ],
                                                                "Cross-Origin-Embedder-Policy": [
                                                                    "require-corp"
                                                                ],
                                                                "Cross-Origin-Resource-Policy": [
                                                                    "same-origin"
                                                                ]
                                                            }
                                                        }
                                                    },
                                                    //Add Accept-Encoding to Vary if Content-Encoding is set
                                                    {
                                                        "handler": "headers",
                                                        "response": {
                                                            "require": {
                                                                "headers": {
                                                                    "Content-Encoding": []
                                                                }
                                                            },
                                                            "set": {
                                                                "Vary": [
                                                                    "Origin, Save-Data, Accept-Encoding"
                                                                ]
                                                            }
                                                        }
                                                    },
                                                    //Add Vary to all responses
                                                    {
                                                        "handler": "headers",
                                                        "response": {
                                                            "set": {
                                                                "Vary": [
                                                                    "Origin, Save-Data"
                                                                ]
                                                            },
                                                            //Required to avoid duplicate headers
                                                            "deferred": true
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "handle": [
                                                    {
                                                        "handler": "vars",
                                                        "root": "/app/public"
                                                    }
                                                ]
                                            },
                                            {
                                                "handle": [
                                                    {
                                                        "handler": "rewrite",
                                                        "uri": "/httperror/{http.error.status_code}/"
                                                    }
                                                ]
                                            },
                                            {
                                                "handle": [
                                                    {
                                                        "handler": "static_response",
                                                        "headers": {
                                                            "Location": [
                                                                "{http.request.orig_uri.path}/"
                                                            ]
                                                        },
                                                        "status_code": 308
                                                    }
                                                ],
                                                "match": [
                                                    {
                                                        "file": {
                                                            "try_files": [
                                                                "{http.request.uri.path}/index.php"
                                                            ]
                                                        },
                                                        "not": [
                                                            {
                                                                "path": [
                                                                    "*/"
                                                                ]
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "handle": [
                                                    {
                                                        "handler": "rewrite",
                                                        "uri": "{http.matchers.file.relative}"
                                                    }
                                                ],
                                                "match": [
                                                    {
                                                        "file": {
                                                            "split_path": [
                                                                ".php"
                                                            ],
                                                            "try_files": [
                                                                "{http.request.uri.path}",
                                                                "{http.request.uri.path}/index.php",
                                                                "index.php"
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "handle": [
                                                    {
                                                        "handler": "php",
                                                        "env": {
                                                            "CADDY_HTTP_ERROR": "{http.error.status_code}",
                                                            "CADDY_HTTP_ERROR_MSG": "{http.error.message}"
                                                        },
                                                        "split_path": [
                                                            ".php"
                                                        ]
                                                    }
                                                ],
                                                "match": [
                                                    {
                                                        "path": [
                                                            "*.php"
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ],
                                "terminal": true
                            }
                        ]
                    }
                }
            }
        }
    }
}