{# Set link variable based on type #}
{% if type == 'bic' %}
    {% set url = 'bictracker/bics' %}
{% elseif type == 'achievement' %}
    {% set url = 'fftracker/achievements' %}
{% elseif type == 'character' %}
    {% set url = 'fftracker/characters' %}
{% elseif type == 'freecompany' %}
    {% set url = 'fftracker/freecompanies' %}
{% elseif type == 'pvpteam' %}
    {% set url = 'fftracker/pvpteams' %}
{% elseif type == 'linkshell' %}
    {% if crossworld %}
        {% set url = 'fftracker/crossworld_linkshells' %}
    {% else %}
        {% set url = 'fftracker/linkshells' %}
    {% endif %}
{% elseif type == 'thread' %}
    {% set url = 'talks/threads' %}
{% endif %}
{# Actual card #}
<a class="entityCard{% if userid and session_data.userid == userid %} ff_owned{% endif %}" href="/{{ url }}/{{ id }}/{{ prettyURL(name) }}/" data-tooltip="{{ name }}">
    <span class="entityIcon">
        {% if type == 'bic' %}
            {% if DateOut %}
                <span class="emojiRed">&#10060;</span>
            {% else %}
                <span class="emojiGreen">&#10004;</span>
            {% endif %}
        {% elseif type == 'achievement' %}
            <img loading="lazy" decoding="async" alt="{{ name }}" src="/img/fftracker/icons/{{ icon }}">
        {% elseif type == 'character' %}
            <img loading="lazy" decoding="async" alt="{{ name }}" src="https://img2.finalfantasyxiv.com/f/{{ icon }}c0_96x96.jpg">
        {% elseif type == 'freecompany' %}
            {% if icon == '1' %}
                <img loading="lazy" decoding="async" alt="{{ name }}" src="/img/fftracker/default-crests/Maelstrom.webp">
            {% elseif icon == '2' %}
                <img loading="lazy" decoding="async" alt="{{ name }}" src="/img/fftracker/default-crests/OrderOfTheTwinAdder.webp">
            {% elseif icon == '3' %}
                <img loading="lazy" decoding="async" alt="{{ name }}" src="/img/fftracker/default-crests/ImmortalFlames.webp">
            {% else %}
                <img loading="lazy" decoding="async" alt="{{ name }}" src="/img/fftracker/merged-crests/{{ icon|slice(0,2) }}/{{ icon|slice(2,2) }}/{{ icon }}.webp">
            {% endif %}
        {% elseif type == 'pvpteam' %}
            <img loading="lazy" decoding="async" alt="{{ name }}" src="/img/fftracker/merged-crests/{{ icon|slice(0,2) }}/{{ icon|slice(2,2) }}/{{ icon }}.webp">
        {% elseif type == 'linkshell' %}
            <img loading="lazy" decoding="async" alt="{{ name }}" src="/img/fftracker/{% if crossworld %}crossworld_{% endif %}linkshell.webp">
        {% else %}
            <img loading="lazy" decoding="async" alt="{{ name }}" src="{{ icon }}">
        {% endif %}
    </span>
    <span class="entityName">
        {% if type == 'thread' %}
            {{ timeTag(thread.updated, "d/m/Y H:i") }}<br>
        {% endif %}
        {% if lsrankid and lsrankid != 3 %}
            <img class="entityRank" loading="lazy" decoding="async" alt="{{ rank }}" data-tooltip="{{ rank }}" src="/img/fftracker/lsranks/{{ lsrankid }}.webp">
        {% endif %}
        {% if pvprankid and pvprankid != 3 %}
            <img class="entityRank" loading="lazy" decoding="async" alt="{{ rank }}" data-tooltip="{{ rank }}" src="/img/fftracker/pvpranks/{{ pvprankid }}.webp">
        {% endif %}
        {% if rankid matches '/^\\d+$/' %}
            <img class="entityRank" loading="lazy" decoding="async" alt="{{ rank }}" data-tooltip="{{ rank }}" src="/img/fftracker/fcranks/{{ rankid }}.webp">
        {% endif %}
        {% if type == 'thread' %}<b>{% if detailedType == 'Changelog' and is_numeric(name) %}{{ timeTag(name, "Y.m.d") }}{% else %}{{ name }}{% endif %}</b>{% else %}{{ name }}{% endif %}{% if userid %}<sup>ðŸ”—</sup>{% endif %}
    </span>
    <span class="entityArrow">&#10151;</span>
</a>
